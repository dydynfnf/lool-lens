; generated by Component: ARM Compiler 5.05 update 2 (build 169) Tool: ArmCC [4d0f38]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\obj\edithex.o --asm_dir=.\list\ --list_dir=.\list\ --depend=.\obj\edithex.d --cpu=Cortex-M3 --apcs=interwork -O0 --diag_suppress=9931 -I.\FWlib\inc -I.\user -I.\CM3 -I.\TFT -I.\GUI\AntiAlias -I.\GUI\Config -I.\GUI\ConvertColor -I.\GUI\ConvertMono -I.\GUI\Core -I.\GUI\Font -I.\GUI\GUI_X -I.\GUI\JPEG -I.\GUI\LCDDriver -I.\GUI\MemDev -I.\GUI\MultiLayer -I.\GUI\Widget -I.\GUI\WM -IC:\Users\Administrator\Desktop\gui\STM32·Ü¶·°å-3.98\RTE -Id:\Keil_v5\ARM\PACK\ARM\CMSIS\4.3.0\CMSIS\Include -Id:\Keil_v5\ARM\PACK\Keil\STM32F1xx_DFP\1.1.0\Device\Include -D__UVISION_VERSION=515 -D_RTE_ -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER -DSTM32F10X_HD -DUSE_STM3210B_EVAL --omf_browse=.\obj\edithex.crf GUI\Widget\EDITHex.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  _HexChar2Int PROC
;;;46     */
;;;47     static int _HexChar2Int(int Char) {
000000  4601              MOV      r1,r0
;;;48       if ((Char >= '0') && (Char <= '9'))
000002  2930              CMP      r1,#0x30
000004  db04              BLT      |L1.16|
000006  2939              CMP      r1,#0x39
000008  dc02              BGT      |L1.16|
;;;49         return Char - '0';
00000a  f1a10030          SUB      r0,r1,#0x30
                  |L1.14|
;;;50       Char &= ~0x20;
;;;51       if ((Char >= 'A') && (Char <= 'F'))
;;;52         return Char - 'A' + 10;
;;;53       return -1;
;;;54     }
00000e  4770              BX       lr
                  |L1.16|
000010  f0210120          BIC      r1,r1,#0x20           ;50
000014  2941              CMP      r1,#0x41              ;51
000016  db04              BLT      |L1.34|
000018  2946              CMP      r1,#0x46              ;51
00001a  dc02              BGT      |L1.34|
00001c  f1a10037          SUB      r0,r1,#0x37           ;52
000020  e7f5              B        |L1.14|
                  |L1.34|
000022  f04f30ff          MOV      r0,#0xffffffff        ;53
000026  e7f2              B        |L1.14|
;;;55     
                          ENDP

                  _UpdateBuffer PROC
;;;59     */
;;;60     static void _UpdateBuffer(EDIT_Handle hObj) {
000028  b538              PUSH     {r3-r5,lr}
00002a  4605              MOV      r5,r0
;;;61       char * s;
;;;62       EDIT_Obj * pObj;
;;;63       pObj = EDIT_H2P(hObj); /* The GUI needs not to be locked here. This function is called only from EDIT_AddKey which has already locked the GUI */
00002c  4628              MOV      r0,r5
00002e  f7fffffe          BL       GUI_ALLOC_h2p
000032  4604              MOV      r4,r0
;;;64       s = (char*) GUI_ALLOC_h2p(pObj->hpText);
000034  f9b40028          LDRSH    r0,[r4,#0x28]
000038  f7fffffe          BL       GUI_ALLOC_h2p
00003c  9000              STR      r0,[sp,#0]
;;;65       GUI_AddHex(pObj->CurrentValue, pObj->MaxLen, &s);
00003e  f894102a          LDRB     r1,[r4,#0x2a]
000042  466a              MOV      r2,sp
000044  6be0              LDR      r0,[r4,#0x3c]
000046  f7fffffe          BL       GUI_AddHex
;;;66     }
00004a  bd38              POP      {r3-r5,pc}
;;;67     
                          ENDP

                  _EditHex PROC
;;;71     */
;;;72     static void _EditHex(int Nibble, EDIT_Obj* pObj, EDIT_Handle hObj) {
00004c  e92d47f0          PUSH     {r4-r10,lr}
000050  4605              MOV      r5,r0
000052  460c              MOV      r4,r1
000054  4616              MOV      r6,r2
;;;73       int Pos = pObj->MaxLen - pObj->CursorPos - 1;   /* Nibble position */
000056  f9b4002a          LDRSH    r0,[r4,#0x2a]
00005a  6c21              LDR      r1,[r4,#0x40]
00005c  1a40              SUBS     r0,r0,r1
00005e  1e47              SUBS     r7,r0,#1
;;;74       U32 AndMask = ~(15     << (Pos << 2));
000060  00b9              LSLS     r1,r7,#2
000062  200f              MOVS     r0,#0xf
000064  4088              LSLS     r0,r0,r1
000066  ea6f0900          MVN      r9,r0
;;;75       U32 OrMask  =   Nibble << (Pos << 2);
00006a  00b8              LSLS     r0,r7,#2
00006c  fa05fa00          LSL      r10,r5,r0
;;;76       I32 Result  = pObj->CurrentValue & AndMask;
000070  6be0              LDR      r0,[r4,#0x3c]
000072  ea000809          AND      r8,r0,r9
;;;77       Result     |= OrMask;
000076  ea48080a          ORR      r8,r8,r10
;;;78       EDIT__SetValueUnsigned(hObj, Result);
00007a  4641              MOV      r1,r8
00007c  4630              MOV      r0,r6
00007e  f7fffffe          BL       EDIT__SetValueUnsigned
;;;79     }
000082  e8bd87f0          POP      {r4-r10,pc}
;;;80     
                          ENDP

                  _GetNumDigits PROC
;;;97     */
;;;98     static int _GetNumDigits(U32 Value) {
000086  4601              MOV      r1,r0
;;;99       int Ret;
;;;100      for (Ret = 0; Value; Value >>= 4, Ret++);
000088  2000              MOVS     r0,#0
00008a  e001              B        |L1.144|
                  |L1.140|
00008c  0909              LSRS     r1,r1,#4
00008e  1c40              ADDS     r0,r0,#1
                  |L1.144|
000090  2900              CMP      r1,#0
000092  d1fb              BNE      |L1.140|
;;;101      return Ret;
;;;102    }
000094  4770              BX       lr
;;;103    
                          ENDP

                  _AddPosition PROC
;;;107    */
;;;108    static void _AddPosition(EDIT_Obj* pObj, EDIT_Handle hObj, int Sign) {
000096  e92d41f0          PUSH     {r4-r8,lr}
00009a  4604              MOV      r4,r0
00009c  460e              MOV      r6,r1
00009e  4617              MOV      r7,r2
;;;109      int Pos;
;;;110      U32 v;
;;;111      v = 1;
0000a0  2501              MOVS     r5,#1
;;;112      Pos = pObj->MaxLen - pObj->CursorPos - 1;
0000a2  f9b4002a          LDRSH    r0,[r4,#0x2a]
0000a6  6c21              LDR      r1,[r4,#0x40]
0000a8  1a40              SUBS     r0,r0,r1
0000aa  f1a00801          SUB      r8,r0,#1
;;;113      while (Pos--) {
0000ae  e000              B        |L1.178|
                  |L1.176|
;;;114        v <<= 4;
0000b0  012d              LSLS     r5,r5,#4
                  |L1.178|
0000b2  ea5f0008          MOVS     r0,r8                 ;113
0000b6  f1a80801          SUB      r8,r8,#1              ;113
0000ba  d1f9              BNE      |L1.176|
;;;115      }
;;;116      if (Sign < 0) {
0000bc  2f00              CMP      r7,#0
0000be  da01              BGE      |L1.196|
;;;117        v = ~v + 1;
0000c0  43e8              MVNS     r0,r5
0000c2  1c45              ADDS     r5,r0,#1
                  |L1.196|
;;;118      }
;;;119      EDIT__SetValueUnsigned(hObj, pObj->CurrentValue + v);
0000c4  6be0              LDR      r0,[r4,#0x3c]
0000c6  1941              ADDS     r1,r0,r5
0000c8  4630              MOV      r0,r6
0000ca  f7fffffe          BL       EDIT__SetValueUnsigned
;;;120    }
0000ce  e8bd81f0          POP      {r4-r8,pc}
;;;121    
                          ENDP

                  _AddKeyHex PROC
;;;131    */
;;;132    static void _AddKeyHex(EDIT_Handle hObj, int Key) {
0000d2  e92d41f0          PUSH     {r4-r8,lr}
0000d6  4605              MOV      r5,r0
0000d8  460e              MOV      r6,r1
;;;133      EDIT_Obj * pObj;
;;;134      pObj = EDIT_H2P(hObj); /* The GUI needs not to be locked here. This function is called only from EDIT_AddKey which has already locked the GUI */
0000da  4628              MOV      r0,r5
0000dc  f7fffffe          BL       GUI_ALLOC_h2p
0000e0  4604              MOV      r4,r0
;;;135      if (pObj) {
0000e2  b39c              CBZ      r4,|L1.332|
;;;136        switch (Key) {
0000e4  2e10              CMP      r6,#0x10
0000e6  d019              BEQ      |L1.284|
0000e8  2e11              CMP      r6,#0x11
0000ea  d004              BEQ      |L1.246|
0000ec  2e12              CMP      r6,#0x12
0000ee  d00f              BEQ      |L1.272|
0000f0  2e13              CMP      r6,#0x13
0000f2  d119              BNE      |L1.296|
0000f4  e005              B        |L1.258|
                  |L1.246|
;;;137          #if EDIT_HEX_DIGITONLY
;;;138          case GUI_KEY_UP:
;;;139            {
;;;140              int Nibble = (_GetCurrentNibble(pObj) + 1) & 15;
;;;141              _EditHex(Nibble, pObj, hObj);
;;;142            }
;;;143            break;
;;;144          case GUI_KEY_DOWN:
;;;145            {
;;;146              int Nibble = (_GetCurrentNibble(pObj) + 1) & 15;
;;;147              _EditHex(Nibble, pObj, hObj);
;;;148            }
;;;149            break;
;;;150          #else
;;;151          case GUI_KEY_UP:
;;;152            _AddPosition(pObj, hObj, 1);
0000f6  2201              MOVS     r2,#1
0000f8  4629              MOV      r1,r5
0000fa  4620              MOV      r0,r4
0000fc  f7fffffe          BL       _AddPosition
;;;153            break;
000100  e023              B        |L1.330|
                  |L1.258|
;;;154          case GUI_KEY_DOWN:
;;;155            _AddPosition(pObj, hObj, -1);
000102  f04f32ff          MOV      r2,#0xffffffff
000106  4629              MOV      r1,r5
000108  4620              MOV      r0,r4
00010a  f7fffffe          BL       _AddPosition
;;;156            break;
00010e  e01c              B        |L1.330|
                  |L1.272|
;;;157          #endif
;;;158          case GUI_KEY_RIGHT:
;;;159            EDIT__SetCursorPos(pObj, pObj->CursorPos + 1);
000110  6c20              LDR      r0,[r4,#0x40]
000112  1c41              ADDS     r1,r0,#1
000114  4620              MOV      r0,r4
000116  f7fffffe          BL       EDIT__SetCursorPos
;;;160            break;
00011a  e016              B        |L1.330|
                  |L1.284|
;;;161          case GUI_KEY_LEFT:
;;;162            EDIT__SetCursorPos(pObj, pObj->CursorPos - 1);
00011c  6c20              LDR      r0,[r4,#0x40]
00011e  1e41              SUBS     r1,r0,#1
000120  4620              MOV      r0,r4
000122  f7fffffe          BL       EDIT__SetCursorPos
;;;163            break;
000126  e010              B        |L1.330|
                  |L1.296|
;;;164          default:
;;;165            {
;;;166              int Nibble = _HexChar2Int(Key);
000128  4630              MOV      r0,r6
00012a  f7fffffe          BL       _HexChar2Int
00012e  4607              MOV      r7,r0
;;;167              if (Nibble >= 0) {
000130  2f00              CMP      r7,#0
000132  db09              BLT      |L1.328|
;;;168                _EditHex(Nibble, pObj, hObj);
000134  462a              MOV      r2,r5
000136  4621              MOV      r1,r4
000138  4638              MOV      r0,r7
00013a  f7fffffe          BL       _EditHex
;;;169                EDIT__SetCursorPos(pObj, pObj->CursorPos + 1);
00013e  6c20              LDR      r0,[r4,#0x40]
000140  1c41              ADDS     r1,r0,#1
000142  4620              MOV      r0,r4
000144  f7fffffe          BL       EDIT__SetCursorPos
                  |L1.328|
;;;170              }
;;;171            }
;;;172            break;
000148  bf00              NOP      
                  |L1.330|
00014a  bf00              NOP                            ;153
                  |L1.332|
;;;173        }
;;;174      }
;;;175      _UpdateBuffer(hObj);
00014c  4628              MOV      r0,r5
00014e  f7fffffe          BL       _UpdateBuffer
;;;176    }
000152  e8bd81f0          POP      {r4-r8,pc}
;;;177    
                          ENDP

                  EDIT_SetHexMode PROC
;;;187    */
;;;188    void EDIT_SetHexMode(EDIT_Handle hEdit, U32 Value, U32 Min, U32 Max) {
000156  e92d47f0          PUSH     {r4-r10,lr}
00015a  4607              MOV      r7,r0
00015c  4688              MOV      r8,r1
00015e  4691              MOV      r9,r2
000160  461e              MOV      r6,r3
;;;189      EDIT_Obj* pObj;
;;;190      WM_LOCK();
;;;191      if (hEdit) {
000162  b35f              CBZ      r7,|L1.444|
;;;192        int MaxLen;
;;;193        pObj = EDIT_H2P(hEdit);
000164  4638              MOV      r0,r7
000166  f7fffffe          BL       GUI_ALLOC_h2p
00016a  4604              MOV      r4,r0
;;;194        pObj->pfAddKeyEx = _AddKeyHex;
00016c  4814              LDR      r0,|L1.448|
00016e  64e0              STR      r0,[r4,#0x4c]
;;;195        pObj->pfUpdateBuffer= _UpdateBuffer;
000170  4814              LDR      r0,|L1.452|
000172  6520              STR      r0,[r4,#0x50]
;;;196        pObj->CurrentValue = Value;
000174  f8c4803c          STR      r8,[r4,#0x3c]
;;;197        pObj->CursorPos = 0;
000178  2000              MOVS     r0,#0
00017a  6420              STR      r0,[r4,#0x40]
;;;198        MaxLen = pObj->MaxLen;
00017c  f9b4502a          LDRSH    r5,[r4,#0x2a]
;;;199        if (MaxLen <= 0 ) {
000180  2d00              CMP      r5,#0
000182  dc03              BGT      |L1.396|
;;;200          MaxLen = _GetNumDigits(Max);
000184  4630              MOV      r0,r6
000186  f7fffffe          BL       _GetNumDigits
00018a  4605              MOV      r5,r0
                  |L1.396|
;;;201        }
;;;202        if (MaxLen > 8) {
00018c  2d08              CMP      r5,#8
00018e  dd00              BLE      |L1.402|
;;;203          MaxLen = 8;
000190  2508              MOVS     r5,#8
                  |L1.402|
;;;204        }
;;;205        if (MaxLen != pObj->MaxLen) {
000192  f9b4002a          LDRSH    r0,[r4,#0x2a]
000196  42a8              CMP      r0,r5
000198  d003              BEQ      |L1.418|
;;;206          EDIT_SetMaxLen(hEdit, MaxLen);
00019a  4629              MOV      r1,r5
00019c  4638              MOV      r0,r7
00019e  f7fffffe          BL       EDIT_SetMaxLen
                  |L1.418|
;;;207        }
;;;208        pObj->Min = Min;
0001a2  f8c49030          STR      r9,[r4,#0x30]
;;;209        pObj->Max = Max;
0001a6  6366              STR      r6,[r4,#0x34]
;;;210        pObj->EditMode = GUI_EDIT_MODE_OVERWRITE;
0001a8  2001              MOVS     r0,#1
0001aa  f8840048          STRB     r0,[r4,#0x48]
;;;211        _UpdateBuffer(hEdit);
0001ae  4638              MOV      r0,r7
0001b0  f7fffffe          BL       _UpdateBuffer
;;;212        WM_Invalidate(hEdit);
0001b4  4638              MOV      r0,r7
0001b6  f7fffffe          BL       WM_InvalidateWindow
;;;213      }
0001ba  bf00              NOP      
                  |L1.444|
;;;214      WM_UNLOCK();
;;;215    }
0001bc  e8bd87f0          POP      {r4-r10,pc}
;;;216    
                          ENDP

                  |L1.448|
                          DCD      _AddKeyHex
                  |L1.452|
                          DCD      _UpdateBuffer
