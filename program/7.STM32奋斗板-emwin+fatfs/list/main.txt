; generated by Component: ARM Compiler 5.05 update 2 (build 169) Tool: ArmCC [4d0f38]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\obj\main.o --asm_dir=.\list\ --list_dir=.\list\ --depend=.\obj\main.d --cpu=Cortex-M3 --apcs=interwork -O0 --diag_suppress=9931 -I.\FWlib\inc -I.\user -I.\CM3 -I.\MALLOC -I.\TFT -I.\EMWIN\EMWIN_INC -I.\EMWIN\DEMO -I.\FATFS -I.\SDIO -I.\PNG -IE:\material\GUI\STM32∑‹∂∑∞Â-emwin+fatfs\RTE -Id:\Keil_v5\ARM\PACK\Keil\STM32F1xx_DFP\1.1.0\Device\Include -Id:\Keil_v5\ARM\CMSIS\Include -D__UVISION_VERSION=515 -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER -DSTM32F10X_HD -DUSE_STM3210B_EVAL --omf_browse=.\obj\main.crf user\main.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  NVIC_Configuration PROC
;;;23     ****************************************************************************/
;;;24     void NVIC_Configuration(void)
000000  b508              PUSH     {r3,lr}
;;;25     {
;;;26       NVIC_InitTypeDef NVIC_InitStructure;
;;;27     
;;;28       /* ”≈œ»º∂◊È1 */
;;;29       NVIC_PriorityGroupConfig(NVIC_PriorityGroup_1);	  
000002  f44f60c0          MOV      r0,#0x600
000006  f7fffffe          BL       NVIC_PriorityGroupConfig
;;;30     
;;;31       NVIC_InitStructure.NVIC_IRQChannel = SDIO_IRQn;			     //SDIO÷–∂œ
00000a  2031              MOVS     r0,#0x31
00000c  f88d0000          STRB     r0,[sp,#0]
;;;32       NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;		 //«¿œ»”≈œ»º∂0  ∑∂Œß£∫0ªÚ1
000010  2000              MOVS     r0,#0
000012  f88d0001          STRB     r0,[sp,#1]
;;;33       NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;			 //◊””≈œ»º∂0	∑∂Œß£∫0-7
000016  f88d0002          STRB     r0,[sp,#2]
;;;34       NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
00001a  2001              MOVS     r0,#1
00001c  f88d0003          STRB     r0,[sp,#3]
;;;35       NVIC_Init(&NVIC_InitStructure);
000020  4668              MOV      r0,sp
000022  f7fffffe          BL       NVIC_Init
;;;36     }
000026  bd08              POP      {r3,pc}
;;;37     
                          ENDP

                  SD_TEST PROC
;;;50     
;;;51     void SD_TEST(void)
000028  b510              PUSH     {r4,lr}
;;;52     {
;;;53     	SD_Status = SD_Init();
00002a  f7fffffe          BL       SD_Init
00002e  496e              LDR      r1,|L1.488|
000030  7008              STRB     r0,[r1,#0]
;;;54         SD_Status = SD_GetCardInfo(&SDCardInfo);
000032  486e              LDR      r0,|L1.492|
000034  f7fffffe          BL       SD_GetCardInfo
000038  496b              LDR      r1,|L1.488|
00003a  7008              STRB     r0,[r1,#0]
;;;55         SD_Status = SD_SelectDeselect((uint32_t) (SDCardInfo.RCA << 16));
00003c  496b              LDR      r1,|L1.492|
00003e  f8b1104c          LDRH     r1,[r1,#0x4c]  ; SDCardInfo
000042  0408              LSLS     r0,r1,#16
000044  f7fffffe          BL       SD_SelectDeselect
000048  4967              LDR      r1,|L1.488|
00004a  7008              STRB     r0,[r1,#0]
;;;56         SD_Status = SD_EnableWideBusOperation(SDIO_BusWide_4b);
00004c  f44f6000          MOV      r0,#0x800
000050  f7fffffe          BL       SD_EnableWideBusOperation
000054  4964              LDR      r1,|L1.488|
000056  7008              STRB     r0,[r1,#0]
;;;57         SD_Status = SD_SetDeviceMode(SD_DMA_MODE);  
000058  2000              MOVS     r0,#0
00005a  f7fffffe          BL       SD_SetDeviceMode
00005e  4962              LDR      r1,|L1.488|
000060  7008              STRB     r0,[r1,#0]
;;;58      	if (SD_Status == SD_OK)
000062  4608              MOV      r0,r1
000064  7800              LDRB     r0,[r0,#0]  ; SD_Status
000066  282a              CMP      r0,#0x2a
000068  d107              BNE      |L1.122|
;;;59       	{
;;;60             // ¥”µÿ÷∑0ø™ º∂¡»°512◊÷Ω⁄  
;;;61         	SD_Status = SD_ReadBlock(Buffer_Block_Rx, 0x00,  512); 
00006a  f44f7200          MOV      r2,#0x200
00006e  2100              MOVS     r1,#0
000070  485f              LDR      r0,|L1.496|
000072  f7fffffe          BL       SD_ReadBlock
000076  495c              LDR      r1,|L1.488|
000078  7008              STRB     r0,[r1,#0]
                  |L1.122|
;;;62       	}
;;;63     }
00007a  bd10              POP      {r4,pc}
;;;64     
                          ENDP

                  RCC_Configuration PROC
;;;72     ****************************************************************************/ 
;;;73     void RCC_Configuration(void){
00007c  b510              PUSH     {r4,lr}
;;;74     
;;;75         SystemInit();	  
00007e  f7fffffe          BL       SystemInit
;;;76         RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC| RCC_APB2Periph_GPIOD| RCC_APB2Periph_GPIOE , ENABLE);
000082  2101              MOVS     r1,#1
000084  2070              MOVS     r0,#0x70
000086  f7fffffe          BL       RCC_APB2PeriphClockCmd
;;;77     	RCC_AHBPeriphClockCmd(RCC_AHBPeriph_CRC, ENABLE);
00008a  2101              MOVS     r1,#1
00008c  2040              MOVS     r0,#0x40
00008e  f7fffffe          BL       RCC_AHBPeriphClockCmd
;;;78         RCC_APB2PeriphClockCmd(RCC_APB2Periph_AFIO, ENABLE);
000092  2101              MOVS     r1,#1
000094  4608              MOV      r0,r1
000096  f7fffffe          BL       RCC_APB2PeriphClockCmd
;;;79     }
00009a  bd10              POP      {r4,pc}
;;;80     
                          ENDP

                  _GetData PROC
;;;87      
;;;88     static int _GetData(void * p, const U8 ** ppData, unsigned NumBytesReq, U32 Off)
00009c  e92d43f8          PUSH     {r3-r9,lr}
;;;89     {
0000a0  4605              MOV      r5,r0
0000a2  460e              MOV      r6,r1
0000a4  4617              MOV      r7,r2
0000a6  461c              MOV      r4,r3
;;;90          static int FileAddress = 0;
;;;91          UINT NumBytesRead;
;;;92          FIL *PicFile;
;;;93      
;;;94          PicFile = (FIL *)p;
0000a8  46a8              MOV      r8,r5
;;;95      
;;;96         
;;;97          if (NumBytesReq > sizeof(_acBuffer)) {
0000aa  f5b77f00          CMP      r7,#0x200
0000ae  d901              BLS      |L1.180|
;;;98          NumBytesReq = sizeof(_acBuffer);
0000b0  f44f7700          MOV      r7,#0x200
                  |L1.180|
;;;99          }
;;;100     
;;;101     
;;;102        
;;;103         if(Off == 1) FileAddress = 0;
0000b4  2c01              CMP      r4,#1
0000b6  d103              BNE      |L1.192|
0000b8  2000              MOVS     r0,#0
0000ba  494e              LDR      r1,|L1.500|
0000bc  6008              STR      r0,[r1,#0]  ; FileAddress
0000be  e001              B        |L1.196|
                  |L1.192|
;;;104         else FileAddress = Off;
0000c0  484c              LDR      r0,|L1.500|
0000c2  6004              STR      r4,[r0,#0]  ; FileAddress
                  |L1.196|
;;;105         result =f_lseek(PicFile, FileAddress);
0000c4  484b              LDR      r0,|L1.500|
0000c6  6801              LDR      r1,[r0,#0]  ; FileAddress
0000c8  4640              MOV      r0,r8
0000ca  f7fffffe          BL       f_lseek
0000ce  494a              LDR      r1,|L1.504|
0000d0  7008              STRB     r0,[r1,#0]
;;;106     
;;;107     
;;;108        
;;;109         result = f_read(PicFile, _acBuffer, NumBytesReq, &NumBytesRead);
0000d2  466b              MOV      r3,sp
0000d4  463a              MOV      r2,r7
0000d6  4949              LDR      r1,|L1.508|
0000d8  4640              MOV      r0,r8
0000da  f7fffffe          BL       f_read
0000de  4946              LDR      r1,|L1.504|
0000e0  7008              STRB     r0,[r1,#0]
;;;110     
;;;111        
;;;112         *ppData = (const U8 *)_acBuffer;
0000e2  4846              LDR      r0,|L1.508|
0000e4  6030              STR      r0,[r6,#0]
;;;113     
;;;114        
;;;115         return NumBytesRead;
0000e6  9800              LDR      r0,[sp,#0]
;;;116    }
0000e8  e8bd83f8          POP      {r3-r9,pc}
;;;117     
                          ENDP

                  _ShowJPGEx PROC
;;;118     
;;;119    static void _ShowJPGEx(const char * sFilename)
0000ec  b57c              PUSH     {r2-r6,lr}
;;;120    {   
0000ee  4604              MOV      r4,r0
;;;121     
;;;122                 
;;;123         result = f_open(&file, sFilename, FA_OPEN_EXISTING | FA_READ | FA_OPEN_ALWAYS);
0000f0  2211              MOVS     r2,#0x11
0000f2  4621              MOV      r1,r4
0000f4  4842              LDR      r0,|L1.512|
0000f6  f7fffffe          BL       f_open
0000fa  493f              LDR      r1,|L1.504|
0000fc  7008              STRB     r0,[r1,#0]
;;;124         if (result != FR_OK)
0000fe  4608              MOV      r0,r1
000100  7800              LDRB     r0,[r0,#0]  ; result
000102  b100              CBZ      r0,|L1.262|
                  |L1.260|
;;;125         {
;;;126             return;
;;;127         }
;;;128        
;;;129         GUI_JPEG_GetInfoEx(_GetData, &file, &JpegInfo);
;;;130                  GUI_JPEG_DrawScaledEx(_GetData,
;;;131                                         &file,
;;;132                                           (LCD_GetXSize() - JpegInfo.XSize)/2,
;;;133                                           (LCD_GetYSize() - JpegInfo.YSize)/2,
;;;134                                           1,
;;;135                                           1); 
;;;136       f_close(&file);
;;;137    }
000104  bd7c              POP      {r2-r6,pc}
                  |L1.262|
000106  4a3f              LDR      r2,|L1.516|
000108  493d              LDR      r1,|L1.512|
00010a  483f              LDR      r0,|L1.520|
00010c  f7fffffe          BL       GUI_JPEG_GetInfoEx
000110  f7fffffe          BL       LCD_GetYSize
000114  493b              LDR      r1,|L1.516|
000116  6849              LDR      r1,[r1,#4]            ;130  ; JpegInfo
000118  1a45              SUBS     r5,r0,r1              ;130
00011a  f7fffffe          BL       LCD_GetXSize
00011e  4939              LDR      r1,|L1.516|
000120  6809              LDR      r1,[r1,#0]            ;130  ; JpegInfo
000122  1a46              SUBS     r6,r0,r1              ;130
000124  2001              MOVS     r0,#1                 ;130
000126  9000              STR      r0,[sp,#0]            ;130
000128  9001              STR      r0,[sp,#4]            ;130
00012a  eb0570d5          ADD      r0,r5,r5,LSR #31      ;130
00012e  1043              ASRS     r3,r0,#1              ;130
000130  eb0670d6          ADD      r0,r6,r6,LSR #31      ;130
000134  1042              ASRS     r2,r0,#1              ;130
000136  4932              LDR      r1,|L1.512|
000138  4833              LDR      r0,|L1.520|
00013a  f7fffffe          BL       GUI_JPEG_DrawScaledEx
00013e  4830              LDR      r0,|L1.512|
000140  f7fffffe          BL       f_close
000144  bf00              NOP      
000146  e7dd              B        |L1.260|
;;;138    
                          ENDP

                  main PROC
;;;150    
;;;151    int main(void)
000148  f5ad7d0c          SUB      sp,sp,#0x230
;;;152    {
;;;153    	
;;;154    	GUI_HMEM hMem;
;;;155    	char *_acBuffer;
;;;156    //	FIL file;
;;;157    //	FRESULT res;
;;;158    	FATFS fs;
;;;159    	
;;;160    	unsigned int br;
;;;161    	
;;;162        RCC_Configuration();  	       //œµÕ≥ ±÷”≥ı ºªØº∞∂Àø⁄Õ‚…Ë ±÷” πƒ‹    
00014c  f7fffffe          BL       RCC_Configuration
;;;163        FSMC_LCD_Init();				   //FSMC TFTΩ”ø⁄≥ı ºª
000150  f7fffffe          BL       FSMC_LCD_Init
;;;164    	SysTick_Config(72000);
000154  492d              LDR      r1,|L1.524|
000156  f1b17f80          CMP      r1,#0x1000000
00015a  d300              BCC      |L1.350|
00015c  e01d              B        |L1.410|
                  |L1.350|
00015e  f021407f          BIC      r0,r1,#0xff000000
000162  1e40              SUBS     r0,r0,#1
000164  f04f22e0          MOV      r2,#0xe000e000
000168  6150              STR      r0,[r2,#0x14]
00016a  1750              ASRS     r0,r2,#29
00016c  220f              MOVS     r2,#0xf
00016e  2800              CMP      r0,#0
000170  da07              BGE      |L1.386|
000172  0713              LSLS     r3,r2,#28
000174  0e1d              LSRS     r5,r3,#24
000176  4b26              LDR      r3,|L1.528|
000178  f000040f          AND      r4,r0,#0xf
00017c  1f24              SUBS     r4,r4,#4
00017e  551d              STRB     r5,[r3,r4]
000180  e003              B        |L1.394|
                  |L1.386|
000182  0713              LSLS     r3,r2,#28
000184  0e1c              LSRS     r4,r3,#24
000186  4b23              LDR      r3,|L1.532|
000188  541c              STRB     r4,[r3,r0]
                  |L1.394|
00018a  bf00              NOP      
00018c  2000              MOVS     r0,#0
00018e  f04f22e0          MOV      r2,#0xe000e000
000192  6190              STR      r0,[r2,#0x18]
000194  2007              MOVS     r0,#7
000196  6110              STR      r0,[r2,#0x10]
000198  bf00              NOP      
                  |L1.410|
;;;165    	LCD_init();
00019a  f7fffffe          BL       LCD_init
;;;166    	NVIC_Configuration();
00019e  f7fffffe          BL       NVIC_Configuration
;;;167    	SD_TEST();
0001a2  f7fffffe          BL       SD_TEST
;;;168    	
;;;169    	GUI_Init();
0001a6  f7fffffe          BL       GUI_Init
;;;170    	GUI_SetFont(&GUI_Font32B_ASCII);
0001aa  481b              LDR      r0,|L1.536|
0001ac  f7fffffe          BL       GUI_SetFont
;;;171    	GUI_SetBkColor(GUI_BLUE);
0001b0  f44f007f          MOV      r0,#0xff0000
0001b4  f7fffffe          BL       GUI_SetBkColor
;;;172    	GUI_SetColor(GUI_YELLOW);
0001b8  f64f70ff          MOV      r0,#0xffff
0001bc  f7fffffe          BL       GUI_SetColor
;;;173    	GUI_Clear();
0001c0  f7fffffe          BL       GUI_Clear
;;;174    	
;;;175    //	hMem = GUI_ALLOC_AllocZero(512);
;;;176    //	_acBuffer = GUI_ALLOC_h2p(hMem);
;;;177    	
;;;178    	disk_initialize(0);						     //fatfsø…“‘π‹¿Ì∂‡∏ˆΩÈ÷ µƒ∑÷«¯£¨ À˘“‘∞—ŒÔ¿Ì¥Ê¥¢ΩÈ÷ SST25VF016B±Í æŒ™0«¯£¨œ‡µ±”⁄¥≈≈Ã±‡∫≈
0001c4  2000              MOVS     r0,#0
0001c6  f7fffffe          BL       disk_initialize
;;;179    	f_mount(0, &fs);
0001ca  4669              MOV      r1,sp
0001cc  2000              MOVS     r0,#0
0001ce  f7fffffe          BL       f_mount
;;;180    	_ShowJPGEx("0:/weather/QQ.jpg");
0001d2  a012              ADR      r0,|L1.540|
0001d4  f7fffffe          BL       _ShowJPGEx
;;;181    	//_ShowPNGEx("0:/weather/cloudy1_night.png",0,0);
;;;182    //	res = f_open(&file, "0:/weather/QQ.jpg", FA_OPEN_EXISTING | FA_OPEN_ALWAYS | FA_READ);
;;;183    //	if(res != FR_OK)
;;;184    //	{
;;;185    //		res=0;
;;;186    //	}
;;;187    //	res = f_read(&file, _acBuffer, file.fsize, &br);
;;;188    //	if(res != FR_OK)
;;;189    //	{
;;;190    //		res=0;
;;;191    //	}
;;;192    //	
;;;193    //	GUI_JPEG_Draw(_acBuffer, file.fsize, 0, 0);
;;;194    //	GUI_ALLOC_Free(hMem);
;;;195    //	f_close(&file);
;;;196    	GUI_DispStringAt("blacklight",0,0);
0001d8  2200              MOVS     r2,#0
0001da  4611              MOV      r1,r2
0001dc  a014              ADR      r0,|L1.560|
0001de  f7fffffe          BL       GUI_DispStringAt
;;;197    	while(1);
0001e2  bf00              NOP      
                  |L1.484|
0001e4  e7fe              B        |L1.484|
;;;198    	
;;;199    }
;;;200    ///****************************************************************************
                          ENDP

0001e6  0000              DCW      0x0000
                  |L1.488|
                          DCD      SD_Status
                  |L1.492|
                          DCD      SDCardInfo
                  |L1.496|
                          DCD      Buffer_Block_Rx
                  |L1.500|
                          DCD      FileAddress
                  |L1.504|
                          DCD      result
                  |L1.508|
                          DCD      _acBuffer
                  |L1.512|
                          DCD      file
                  |L1.516|
                          DCD      JpegInfo
                  |L1.520|
                          DCD      _GetData
                  |L1.524|
                          DCD      0x00011940
                  |L1.528|
                          DCD      0xe000ed18
                  |L1.532|
                          DCD      0xe000e400
                  |L1.536|
                          DCD      GUI_Font32B_ASCII
                  |L1.540|
00021c  303a2f77          DCB      "0:/weather/QQ.jpg",0
000220  65617468
000224  65722f51
000228  512e6a70
00022c  6700    
00022e  00                DCB      0
00022f  00                DCB      0
                  |L1.560|
000230  626c6163          DCB      "blacklight",0
000234  6b6c6967
000238  687400  
00023b  00                DCB      0

                          AREA ||.bss||, DATA, NOINIT, ALIGN=2

                  Buffer_Block_Tx
                          %        2048
                  Buffer_Block_Rx
                          %        2048
                  _acBuffer
                          %        512
                  file
                          %        552

                          AREA ||.data||, DATA, ALIGN=2

                  SD_Status
000000  2a000000          DCB      0x2a,0x00,0x00,0x00
                  JpegInfo
                          %        8
                  result
00000c  00                DCB      0x00
                  i
00000d  ff0000            DCB      0xff,0x00,0x00
                  pastms
                          DCD      0x00000000
                  FileAddress
                          DCD      0x00000000

                  __ARM_use_no_argv EQU 0
