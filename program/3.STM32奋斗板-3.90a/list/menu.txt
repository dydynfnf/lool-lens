; generated by ARM C/C++ Compiler, 4.1 [Build 791]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\obj\menu.o --asm_dir=.\list\ --list_dir=.\list\ --depend=.\obj\menu.d --cpu=Cortex-M3 --apcs=interwork -O0 -I.\FWlib\inc -I.\user -I.\CM3 -I.\TFT -I.\GUI\AntiAlias -I.\GUI\Config -I.\GUI\ConvertColor -I.\GUI\ConvertMono -I.\GUI\Core -I.\GUI\Font -I.\GUI\GUI_X -I.\GUI\JPEG -I.\GUI\LCDDriver -I.\GUI\MemDev -I.\GUI\MultiLayer -I.\GUI\Widget -I.\GUI\WM -Id:\Keil\ARM\CMSIS\Include -Id:\Keil\ARM\INC\ST\STM32F10x -DUSE_STDPERIPH_DRIVER -DSTM32F10X_HD -DUSE_STM3210B_EVAL --omf_browse=.\obj\menu.crf GUI\Widget\MENU.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  MENU__SendMenuMessage PROC
;;;1110   */
;;;1111   int MENU__SendMenuMessage(MENU_Handle hObj, WM_HWIN hDestWin, U16 MsgType, U16 ItemId) {
000000  e92d41ff          PUSH     {r0-r8,lr}
000004  4605              MOV      r5,r0
000006  460c              MOV      r4,r1
000008  4616              MOV      r6,r2
00000a  461f              MOV      r7,r3
;;;1112     MENU_MSG_DATA MsgData;
;;;1113     WM_MESSAGE    Msg = {0};
00000c  f04f0000          MOV      r0,#0
000010  9000              STR      r0,[sp,#0]
000012  9001              STR      r0,[sp,#4]
000014  9002              STR      r0,[sp,#8]
;;;1114     MsgData.MsgType   = MsgType;
000016  f8ad600c          STRH     r6,[sp,#0xc]
;;;1115     MsgData.ItemId    = ItemId;
00001a  f8ad700e          STRH     r7,[sp,#0xe]
;;;1116     Msg.MsgId         = WM_MENU;
00001e  f04f002c          MOV      r0,#0x2c
000022  9000              STR      r0,[sp,#0]
;;;1117     Msg.Data.p        = &MsgData;
000024  a803              ADD      r0,sp,#0xc
000026  9002              STR      r0,[sp,#8]
;;;1118     Msg.hWinSrc       = hObj;
000028  f8ad5006          STRH     r5,[sp,#6]
;;;1119     if (!hDestWin) {
00002c  b91c              CBNZ     r4,|L1.54|
;;;1120       hDestWin = WM_GetParent(hObj);
00002e  4628              MOV      r0,r5
000030  f7fffffe          BL       WM_GetParent
000034  4604              MOV      r4,r0
                  |L1.54|
;;;1121     }
;;;1122     if (hDestWin) {
000036  b13c              CBZ      r4,|L1.72|
;;;1123       WM__SendMessage(hDestWin, &Msg);
000038  4669              MOV      r1,sp
00003a  4620              MOV      r0,r4
00003c  f7fffffe          BL       WM__SendMessage
;;;1124       return Msg.Data.v;
000040  9802              LDR      r0,[sp,#8]
                  |L1.66|
;;;1125     }
;;;1126     return 0;
;;;1127   }
000042  b004              ADD      sp,sp,#0x10
000044  e8bd81f0          POP      {r4-r8,pc}
                  |L1.72|
000048  2000              MOVS     r0,#0                 ;1126
00004a  e7fa              B        |L1.66|
;;;1128   
                          ENDP

                  _IsTopLevelMenu PROC
;;;186    */
;;;187    static char _IsTopLevelMenu(MENU_Handle hObj, const MENU_Obj* pObj) {
00004c  b570              PUSH     {r4-r6,lr}
00004e  4605              MOV      r5,r0
000050  460c              MOV      r4,r1
;;;188      if (MENU__SendMenuMessage(hObj, pObj->hOwner, MENU_IS_MENU, 0) == 0) {
000052  f9b4105c          LDRSH    r1,[r4,#0x5c]
000056  f04f0300          MOV      r3,#0
00005a  f04f0205          MOV      r2,#5
00005e  4628              MOV      r0,r5
000060  f7fffffe          BL       MENU__SendMenuMessage
000064  b908              CBNZ     r0,|L1.106|
;;;189        return 1;
000066  2001              MOVS     r0,#1
                  |L1.104|
;;;190      }
;;;191      return 0;
;;;192    }
000068  bd70              POP      {r4-r6,pc}
                  |L1.106|
00006a  2000              MOVS     r0,#0                 ;191
00006c  e7fc              B        |L1.104|
;;;193    
                          ENDP

                  _HasEffect PROC
;;;197    */
;;;198    static int _HasEffect(MENU_Handle hObj, MENU_Obj* pObj) {
00006e  b570              PUSH     {r4-r6,lr}
000070  4605              MOV      r5,r0
000072  460c              MOV      r4,r1
;;;199      if (!(pObj->Flags & MENU_SF_POPUP)) {
000074  f8b4005e          LDRH     r0,[r4,#0x5e]
000078  f0100f80          TST      r0,#0x80
00007c  d106              BNE      |L1.140|
;;;200        if (_IsTopLevelMenu(hObj, pObj)) {
00007e  4621              MOV      r1,r4
000080  4628              MOV      r0,r5
000082  f7fffffe          BL       _IsTopLevelMenu
000086  b108              CBZ      r0,|L1.140|
;;;201          return 0;
000088  2000              MOVS     r0,#0
                  |L1.138|
;;;202        }
;;;203      }
;;;204      return 1;
;;;205    }
00008a  bd70              POP      {r4-r6,pc}
                  |L1.140|
00008c  2001              MOVS     r0,#1                 ;204
00008e  e7fc              B        |L1.138|
;;;206    
                          ENDP

                  _GetEffectSize PROC
;;;210    */
;;;211    static int _GetEffectSize(MENU_Handle hObj, MENU_Obj* pObj) {
000090  b570              PUSH     {r4-r6,lr}
000092  4605              MOV      r5,r0
000094  460c              MOV      r4,r1
;;;212      int r = 0;
000096  f04f0600          MOV      r6,#0
;;;213      if (_HasEffect(hObj, pObj)) { 
00009a  4621              MOV      r1,r4
00009c  4628              MOV      r0,r5
00009e  f7fffffe          BL       _HasEffect
0000a2  b108              CBZ      r0,|L1.168|
;;;214        r = pObj->Widget.pEffect->EffectSize;
0000a4  6a20              LDR      r0,[r4,#0x20]
0000a6  6946              LDR      r6,[r0,#0x14]
                  |L1.168|
;;;215      }
;;;216      return r;
0000a8  4630              MOV      r0,r6
;;;217    }
0000aa  bd70              POP      {r4-r6,pc}
;;;218    
                          ENDP

                  _CalcTextWidth PROC
;;;222    */
;;;223    static int _CalcTextWidth(MENU_Obj* pObj, const char GUI_UNI_PTR* sText) {
0000ac  e92d41f0          PUSH     {r4-r8,lr}
0000b0  4605              MOV      r5,r0
0000b2  460c              MOV      r4,r1
;;;224      int TextWidth = 0;
0000b4  f04f0600          MOV      r6,#0
;;;225      if (sText) {
0000b8  b15c              CBZ      r4,|L1.210|
;;;226        const GUI_FONT GUI_UNI_PTR* pOldFont;
;;;227        pOldFont  = GUI_SetFont(pObj->Props.pFont);
0000ba  6d68              LDR      r0,[r5,#0x54]
0000bc  f7fffffe          BL       GUI_SetFont
0000c0  4607              MOV      r7,r0
;;;228        TextWidth = GUI_GetStringDistX(sText);
0000c2  4620              MOV      r0,r4
0000c4  f7fffffe          BL       GUI_GetStringDistX
0000c8  4606              MOV      r6,r0
;;;229        GUI_SetFont(pOldFont);
0000ca  4638              MOV      r0,r7
0000cc  f7fffffe          BL       GUI_SetFont
;;;230      }
0000d0  bf00              NOP      
                  |L1.210|
;;;231      return TextWidth;
0000d2  4630              MOV      r0,r6
;;;232    }
0000d4  e8bd81f0          POP      {r4-r8,pc}
;;;233    
                          ENDP

                  _GetItemWidth PROC
;;;237    */
;;;238    static int _GetItemWidth(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index) {
0000d8  e92d41f0          PUSH     {r4-r8,lr}
0000dc  4680              MOV      r8,r0
0000de  460c              MOV      r4,r1
0000e0  4616              MOV      r6,r2
;;;239      int ItemWidth;
;;;240      if (pObj->Width && (pObj->Flags & MENU_SF_VERTICAL)) {
0000e2  6e60              LDR      r0,[r4,#0x64]
0000e4  b160              CBZ      r0,|L1.256|
0000e6  f8b4005e          LDRH     r0,[r4,#0x5e]
0000ea  f0100f01          TST      r0,#1
0000ee  d007              BEQ      |L1.256|
;;;241        ItemWidth = pObj->Width - (_GetEffectSize(hObj, pObj) << 1);
0000f0  4621              MOV      r1,r4
0000f2  4640              MOV      r0,r8
0000f4  f7fffffe          BL       _GetEffectSize
0000f8  6e61              LDR      r1,[r4,#0x64]
0000fa  eba10540          SUB      r5,r1,r0,LSL #1
0000fe  e019              B        |L1.308|
                  |L1.256|
;;;242      } else {
;;;243        MENU_ITEM* pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
000100  4631              MOV      r1,r6
000102  f1040058          ADD      r0,r4,#0x58
000106  f7fffffe          BL       GUI_ARRAY_GetpItem
00010a  4607              MOV      r7,r0
;;;244        if ((pObj->Flags & MENU_SF_VERTICAL) || !(pItem->Flags & MENU_IF_SEPARATOR)) {
00010c  f8b4005e          LDRH     r0,[r4,#0x5e]
000110  f0100f01          TST      r0,#1
000114  d103              BNE      |L1.286|
000116  88b8              LDRH     r0,[r7,#4]
000118  f0100f02          TST      r0,#2
00011c  d101              BNE      |L1.290|
                  |L1.286|
;;;245          ItemWidth = pItem->TextWidth;
00011e  68bd              LDR      r5,[r7,#8]
000120  e001              B        |L1.294|
                  |L1.290|
;;;246        } else {
;;;247          ItemWidth = 3;
000122  f04f0503          MOV      r5,#3
                  |L1.294|
;;;248       }
;;;249        ItemWidth += pObj->Props.aBorder[MENU_BI_LEFT] + pObj->Props.aBorder[MENU_BI_RIGHT];
000126  f8941050          LDRB     r1,[r4,#0x50]
00012a  f8940051          LDRB     r0,[r4,#0x51]
00012e  4408              ADD      r0,r0,r1
000130  4405              ADD      r5,r5,r0
;;;250      }
000132  bf00              NOP      
                  |L1.308|
;;;251      return ItemWidth;
000134  4628              MOV      r0,r5
;;;252    }
000136  e8bd81f0          POP      {r4-r8,pc}
;;;253    
                          ENDP

                  _GetItemHeight PROC
;;;257    */
;;;258    static int _GetItemHeight(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index) {
00013a  e92d41f0          PUSH     {r4-r8,lr}
00013e  4607              MOV      r7,r0
000140  460c              MOV      r4,r1
000142  4616              MOV      r6,r2
;;;259      int ItemHeight;
;;;260      if (pObj->Height && !(pObj->Flags & MENU_SF_VERTICAL)) {
000144  6ea0              LDR      r0,[r4,#0x68]
000146  b160              CBZ      r0,|L1.354|
000148  f8b4005e          LDRH     r0,[r4,#0x5e]
00014c  f0100f01          TST      r0,#1
000150  d107              BNE      |L1.354|
;;;261        ItemHeight = pObj->Height - (_GetEffectSize(hObj, pObj) << 1);
000152  4621              MOV      r1,r4
000154  4638              MOV      r0,r7
000156  f7fffffe          BL       _GetEffectSize
00015a  6ea1              LDR      r1,[r4,#0x68]
00015c  eba10540          SUB      r5,r1,r0,LSL #1
000160  e01c              B        |L1.412|
                  |L1.354|
;;;262      } else {
;;;263        ItemHeight = GUI_GetYDistOfFont(pObj->Props.pFont);
000162  6d60              LDR      r0,[r4,#0x54]
000164  f7fffffe          BL       GUI_GetYDistOfFont
000168  4605              MOV      r5,r0
;;;264        if (pObj->Flags & MENU_SF_VERTICAL) {
00016a  f8b4005e          LDRH     r0,[r4,#0x5e]
00016e  f0100f01          TST      r0,#1
000172  d00d              BEQ      |L1.400|
;;;265          MENU_ITEM* pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
000174  4631              MOV      r1,r6
000176  f1040058          ADD      r0,r4,#0x58
00017a  f7fffffe          BL       GUI_ARRAY_GetpItem
00017e  4680              MOV      r8,r0
;;;266          if (pItem->Flags & MENU_IF_SEPARATOR) {
000180  f8b80004          LDRH     r0,[r8,#4]
000184  f0100f02          TST      r0,#2
000188  d001              BEQ      |L1.398|
;;;267            ItemHeight = 3;
00018a  f04f0503          MOV      r5,#3
                  |L1.398|
;;;268          }
;;;269        }
00018e  bf00              NOP      
                  |L1.400|
;;;270        ItemHeight += pObj->Props.aBorder[MENU_BI_TOP] + pObj->Props.aBorder[MENU_BI_BOTTOM];
000190  f8941052          LDRB     r1,[r4,#0x52]
000194  f8940053          LDRB     r0,[r4,#0x53]
000198  4408              ADD      r0,r0,r1
00019a  4405              ADD      r5,r5,r0
                  |L1.412|
;;;271      }
;;;272      return ItemHeight;
00019c  4628              MOV      r0,r5
;;;273    }
00019e  e8bd81f0          POP      {r4-r8,pc}
;;;274    
                          ENDP

                  MENU__GetNumItems PROC
;;;1026   */
;;;1027   unsigned MENU__GetNumItems(MENU_Obj* pObj) {
0001a2  b510              PUSH     {r4,lr}
0001a4  4604              MOV      r4,r0
;;;1028     return GUI_ARRAY_GetNumItems(&pObj->ItemArray);
0001a6  f1040058          ADD      r0,r4,#0x58
0001aa  f7fffffe          BL       GUI_ARRAY_GetNumItems
;;;1029   }
0001ae  bd10              POP      {r4,pc}
;;;1030   
                          ENDP

                  _CalcMenuSizeX PROC
;;;278    */
;;;279    static int _CalcMenuSizeX(MENU_Handle hObj, MENU_Obj* pObj) {
0001b0  e92d47f0          PUSH     {r4-r10,lr}
0001b4  4681              MOV      r9,r0
0001b6  460f              MOV      r7,r1
;;;280      unsigned i, NumItems = MENU__GetNumItems(pObj);
0001b8  4638              MOV      r0,r7
0001ba  f7fffffe          BL       MENU__GetNumItems
0001be  4680              MOV      r8,r0
;;;281      int xSize = 0;
0001c0  f04f0500          MOV      r5,#0
;;;282      if (pObj->Flags & MENU_SF_VERTICAL) {
0001c4  f8b7005e          LDRH     r0,[r7,#0x5e]
0001c8  f0100f01          TST      r0,#1
0001cc  d00f              BEQ      |L1.494|
;;;283        int ItemWidth;
;;;284        for (i = 0; i < NumItems; i++) {
0001ce  462c              MOV      r4,r5
0001d0  e00a              B        |L1.488|
                  |L1.466|
;;;285          ItemWidth = _GetItemWidth(hObj, pObj, i);
0001d2  4622              MOV      r2,r4
0001d4  4639              MOV      r1,r7
0001d6  4648              MOV      r0,r9
0001d8  f7fffffe          BL       _GetItemWidth
0001dc  4606              MOV      r6,r0
;;;286          if (ItemWidth > xSize) {
0001de  42ae              CMP      r6,r5
0001e0  dd00              BLE      |L1.484|
;;;287            xSize = ItemWidth;
0001e2  4635              MOV      r5,r6
                  |L1.484|
0001e4  f1040401          ADD      r4,r4,#1              ;284
                  |L1.488|
0001e8  4544              CMP      r4,r8                 ;284
0001ea  d3f2              BCC      |L1.466|
;;;288          }
;;;289        }
;;;290      } else {
0001ec  e00c              B        |L1.520|
                  |L1.494|
;;;291        for (i = 0; i < NumItems; i++) {
0001ee  f04f0400          MOV      r4,#0
0001f2  e007              B        |L1.516|
                  |L1.500|
;;;292          xSize += _GetItemWidth(hObj, pObj, i);
0001f4  4622              MOV      r2,r4
0001f6  4639              MOV      r1,r7
0001f8  4648              MOV      r0,r9
0001fa  f7fffffe          BL       _GetItemWidth
0001fe  4405              ADD      r5,r5,r0
000200  f1040401          ADD      r4,r4,#1              ;291
                  |L1.516|
000204  4544              CMP      r4,r8                 ;291
000206  d3f5              BCC      |L1.500|
                  |L1.520|
;;;293        }
;;;294      }
;;;295      xSize += (_GetEffectSize(hObj, pObj) << 1);
000208  4639              MOV      r1,r7
00020a  4648              MOV      r0,r9
00020c  f7fffffe          BL       _GetEffectSize
000210  eb050540          ADD      r5,r5,r0,LSL #1
;;;296      return xSize;
000214  4628              MOV      r0,r5
;;;297    }
000216  e8bd87f0          POP      {r4-r10,pc}
;;;298    
                          ENDP

                  _CalcMenuSizeY PROC
;;;302    */
;;;303    static int _CalcMenuSizeY(MENU_Handle hObj, MENU_Obj* pObj) {
00021a  e92d47f0          PUSH     {r4-r10,lr}
00021e  4681              MOV      r9,r0
000220  460f              MOV      r7,r1
;;;304      unsigned i, NumItems = MENU__GetNumItems(pObj);
000222  4638              MOV      r0,r7
000224  f7fffffe          BL       MENU__GetNumItems
000228  4680              MOV      r8,r0
;;;305      int ySize = 0;
00022a  f04f0500          MOV      r5,#0
;;;306      if (pObj->Flags & MENU_SF_VERTICAL) {
00022e  f8b7005e          LDRH     r0,[r7,#0x5e]
000232  f0100f01          TST      r0,#1
000236  d00c              BEQ      |L1.594|
;;;307        for (i = 0; i < NumItems; i++) {
000238  462c              MOV      r4,r5
00023a  e007              B        |L1.588|
                  |L1.572|
;;;308          ySize += _GetItemHeight(hObj, pObj, i);
00023c  4622              MOV      r2,r4
00023e  4639              MOV      r1,r7
000240  4648              MOV      r0,r9
000242  f7fffffe          BL       _GetItemHeight
000246  4405              ADD      r5,r5,r0
000248  f1040401          ADD      r4,r4,#1              ;307
                  |L1.588|
00024c  4544              CMP      r4,r8                 ;307
00024e  d3f5              BCC      |L1.572|
000250  e010              B        |L1.628|
                  |L1.594|
;;;309        }
;;;310      } else {
;;;311        int ItemHeight;
;;;312        for (i = 0; i < NumItems; i++) {
000252  f04f0400          MOV      r4,#0
000256  e00a              B        |L1.622|
                  |L1.600|
;;;313          ItemHeight = _GetItemHeight(hObj, pObj, i);
000258  4622              MOV      r2,r4
00025a  4639              MOV      r1,r7
00025c  4648              MOV      r0,r9
00025e  f7fffffe          BL       _GetItemHeight
000262  4606              MOV      r6,r0
;;;314          if (ItemHeight > ySize) {
000264  42ae              CMP      r6,r5
000266  dd00              BLE      |L1.618|
;;;315            ySize = ItemHeight;
000268  4635              MOV      r5,r6
                  |L1.618|
00026a  f1040401          ADD      r4,r4,#1              ;312
                  |L1.622|
00026e  4544              CMP      r4,r8                 ;312
000270  d3f2              BCC      |L1.600|
;;;316          }
;;;317        }
;;;318      }
000272  bf00              NOP      
                  |L1.628|
;;;319      ySize += (_GetEffectSize(hObj, pObj) << 1);
000274  4639              MOV      r1,r7
000276  4648              MOV      r0,r9
000278  f7fffffe          BL       _GetEffectSize
00027c  eb050540          ADD      r5,r5,r0,LSL #1
;;;320      return ySize;
000280  4628              MOV      r0,r5
;;;321    }
000282  e8bd87f0          POP      {r4-r10,pc}
;;;322    
                          ENDP

                  _CalcWindowSizeX PROC
;;;326    */
;;;327    static int _CalcWindowSizeX(MENU_Handle hObj, MENU_Obj* pObj) {
000286  b570              PUSH     {r4-r6,lr}
000288  4606              MOV      r6,r0
00028a  460c              MOV      r4,r1
;;;328      int xSize = pObj->Width;
00028c  6e65              LDR      r5,[r4,#0x64]
;;;329      if (xSize == 0) {
00028e  b925              CBNZ     r5,|L1.666|
;;;330        xSize = _CalcMenuSizeX(hObj, pObj);
000290  4621              MOV      r1,r4
000292  4630              MOV      r0,r6
000294  f7fffffe          BL       _CalcMenuSizeX
000298  4605              MOV      r5,r0
                  |L1.666|
;;;331      }
;;;332      return xSize;
00029a  4628              MOV      r0,r5
;;;333    }
00029c  bd70              POP      {r4-r6,pc}
;;;334    
                          ENDP

                  _CalcWindowSizeY PROC
;;;338    */
;;;339    static int _CalcWindowSizeY(MENU_Handle hObj, MENU_Obj* pObj) {
00029e  b570              PUSH     {r4-r6,lr}
0002a0  4606              MOV      r6,r0
0002a2  460c              MOV      r4,r1
;;;340      int ySize = pObj->Height;
0002a4  6ea5              LDR      r5,[r4,#0x68]
;;;341      if (ySize == 0) {
0002a6  b925              CBNZ     r5,|L1.690|
;;;342        ySize = _CalcMenuSizeY(hObj, pObj);
0002a8  4621              MOV      r1,r4
0002aa  4630              MOV      r0,r6
0002ac  f7fffffe          BL       _CalcMenuSizeY
0002b0  4605              MOV      r5,r0
                  |L1.690|
;;;343      }
;;;344      return ySize;
0002b2  4628              MOV      r0,r5
;;;345    }
0002b4  bd70              POP      {r4-r6,pc}
;;;346    
                          ENDP

                  _GetItemFromPos PROC
;;;357    */
;;;358    static int _GetItemFromPos(MENU_Handle hObj, MENU_Obj* pObj, int x, int y) {
0002b6  e92d4fff          PUSH     {r0-r11,lr}
0002ba  b083              SUB      sp,sp,#0xc
0002bc  460c              MOV      r4,r1
0002be  4617              MOV      r7,r2
0002c0  4698              MOV      r8,r3
;;;359      int xSize, ySize, EffectSize, r = -1;
0002c2  f04f30ff          MOV      r0,#0xffffffff
0002c6  9002              STR      r0,[sp,#8]
;;;360      ySize = _CalcMenuSizeY(hObj, pObj);
0002c8  4621              MOV      r1,r4
0002ca  9803              LDR      r0,[sp,#0xc]
0002cc  f7fffffe          BL       _CalcMenuSizeY
0002d0  4682              MOV      r10,r0
;;;361      if ((pObj->Height) && (pObj->Height < ySize)) {
0002d2  6ea0              LDR      r0,[r4,#0x68]
0002d4  b120              CBZ      r0,|L1.736|
0002d6  6ea0              LDR      r0,[r4,#0x68]
0002d8  4550              CMP      r0,r10
0002da  da01              BGE      |L1.736|
;;;362        ySize = pObj->Height;
0002dc  f8d4a068          LDR      r10,[r4,#0x68]
                  |L1.736|
;;;363      }
;;;364      xSize = _CalcMenuSizeX(hObj, pObj);
0002e0  4621              MOV      r1,r4
0002e2  9803              LDR      r0,[sp,#0xc]
0002e4  f7fffffe          BL       _CalcMenuSizeX
0002e8  4681              MOV      r9,r0
;;;365      if ((pObj->Width) && (pObj->Width < xSize)) {
0002ea  6e60              LDR      r0,[r4,#0x64]
0002ec  b120              CBZ      r0,|L1.760|
0002ee  6e60              LDR      r0,[r4,#0x64]
0002f0  4548              CMP      r0,r9
0002f2  da01              BGE      |L1.760|
;;;366        xSize = pObj->Width;
0002f4  f8d49064          LDR      r9,[r4,#0x64]
                  |L1.760|
;;;367      }
;;;368      EffectSize = _GetEffectSize(hObj, pObj);
0002f8  4621              MOV      r1,r4
0002fa  9803              LDR      r0,[sp,#0xc]
0002fc  f7fffffe          BL       _GetEffectSize
000300  4606              MOV      r6,r0
;;;369      x     -= EffectSize;
000302  eba70706          SUB      r7,r7,r6
;;;370      y     -= EffectSize;
000306  eba80806          SUB      r8,r8,r6
;;;371      xSize -= (EffectSize << 1);
00030a  eba90946          SUB      r9,r9,r6,LSL #1
;;;372      ySize -= (EffectSize << 1);
00030e  ebaa0a46          SUB      r10,r10,r6,LSL #1
;;;373      if ((x >= 0) && (y >= 0) && (x < xSize) && (y < ySize)) {
000312  2f00              CMP      r7,#0
000314  db3a              BLT      |L1.908|
000316  f1b80f00          CMP      r8,#0
00031a  db37              BLT      |L1.908|
00031c  454f              CMP      r7,r9
00031e  da35              BGE      |L1.908|
000320  45d0              CMP      r8,r10
000322  da33              BGE      |L1.908|
;;;374        unsigned i, NumItems = MENU__GetNumItems(pObj);
000324  4620              MOV      r0,r4
000326  f7fffffe          BL       MENU__GetNumItems
00032a  9001              STR      r0,[sp,#4]
;;;375        if (pObj->Flags & MENU_SF_VERTICAL) {
00032c  f8b4005e          LDRH     r0,[r4,#0x5e]
000330  f0100f01          TST      r0,#1
000334  d014              BEQ      |L1.864|
;;;376          int yPos = 0;
000336  f04f0b00          MOV      r11,#0
;;;377          for (i = 0; i < NumItems; i++) {
00033a  465d              MOV      r5,r11
00033c  e00b              B        |L1.854|
                  |L1.830|
;;;378            yPos += _GetItemHeight(hObj, pObj, i);
00033e  462a              MOV      r2,r5
000340  4621              MOV      r1,r4
000342  9803              LDR      r0,[sp,#0xc]
000344  f7fffffe          BL       _GetItemHeight
000348  4483              ADD      r11,r11,r0
;;;379            if (y < yPos) {
00034a  45d8              CMP      r8,r11
00034c  da01              BGE      |L1.850|
;;;380              r = i;
00034e  9502              STR      r5,[sp,#8]
;;;381              break;
000350  e004              B        |L1.860|
                  |L1.850|
000352  f1050501          ADD      r5,r5,#1              ;377
                  |L1.854|
000356  9801              LDR      r0,[sp,#4]            ;377
000358  4285              CMP      r5,r0                 ;377
00035a  d3f0              BCC      |L1.830|
                  |L1.860|
00035c  bf00              NOP      
;;;382            }
;;;383          }
;;;384        } else {
00035e  e014              B        |L1.906|
                  |L1.864|
;;;385          int xPos = 0;
000360  f04f0b00          MOV      r11,#0
;;;386          for (i = 0; i < NumItems; i++) {
000364  465d              MOV      r5,r11
000366  e00b              B        |L1.896|
                  |L1.872|
;;;387            xPos += _GetItemWidth(hObj, pObj, i);
000368  462a              MOV      r2,r5
00036a  4621              MOV      r1,r4
00036c  9803              LDR      r0,[sp,#0xc]
00036e  f7fffffe          BL       _GetItemWidth
000372  4483              ADD      r11,r11,r0
;;;388            if (x < xPos) {
000374  455f              CMP      r7,r11
000376  da01              BGE      |L1.892|
;;;389              r = i;
000378  9502              STR      r5,[sp,#8]
;;;390              break;
00037a  e004              B        |L1.902|
                  |L1.892|
00037c  f1050501          ADD      r5,r5,#1              ;386
                  |L1.896|
000380  9801              LDR      r0,[sp,#4]            ;386
000382  4285              CMP      r5,r0                 ;386
000384  d3f0              BCC      |L1.872|
                  |L1.902|
000386  bf00              NOP      
;;;391            }
;;;392          }
;;;393        }
000388  bf00              NOP      
                  |L1.906|
;;;394      }
00038a  bf00              NOP      
                  |L1.908|
;;;395      return r;
00038c  9802              LDR      r0,[sp,#8]
;;;396    }
00038e  b007              ADD      sp,sp,#0x1c
000390  e8bd8ff0          POP      {r4-r11,pc}
;;;397    
                          ENDP

                  _GetItemPos PROC
;;;401    */
;;;402    static void _GetItemPos(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index, int* px, int* py) {
000394  e92d5ff0          PUSH     {r4-r12,lr}
000398  4683              MOV      r11,r0
00039a  4688              MOV      r8,r1
00039c  4616              MOV      r6,r2
00039e  461f              MOV      r7,r3
0003a0  f8dd9028          LDR      r9,[sp,#0x28]
;;;403      int i, EffectSize;
;;;404      EffectSize = _GetEffectSize(hObj, pObj);
0003a4  4641              MOV      r1,r8
0003a6  4658              MOV      r0,r11
0003a8  f7fffffe          BL       _GetEffectSize
0003ac  4605              MOV      r5,r0
;;;405      if (pObj->Flags & MENU_SF_VERTICAL) {
0003ae  f8b8005e          LDRH     r0,[r8,#0x5e]
0003b2  f0100f01          TST      r0,#1
0003b6  d013              BEQ      |L1.992|
;;;406        int yPos = 0;
0003b8  f04f0a00          MOV      r10,#0
;;;407        for (i = 0; i < (int)Index; i++) {
0003bc  4654              MOV      r4,r10
0003be  e007              B        |L1.976|
                  |L1.960|
;;;408          yPos += _GetItemHeight(hObj, pObj, i);
0003c0  4622              MOV      r2,r4
0003c2  4641              MOV      r1,r8
0003c4  4658              MOV      r0,r11
0003c6  f7fffffe          BL       _GetItemHeight
0003ca  4482              ADD      r10,r10,r0
0003cc  f1040401          ADD      r4,r4,#1              ;407
                  |L1.976|
0003d0  42b4              CMP      r4,r6                 ;407
0003d2  dbf5              BLT      |L1.960|
;;;409        }
;;;410        *px = EffectSize;
0003d4  603d              STR      r5,[r7,#0]
;;;411        *py = EffectSize + yPos;
0003d6  eb05000a          ADD      r0,r5,r10
0003da  f8c90000          STR      r0,[r9,#0]
;;;412      } else {
0003de  e013              B        |L1.1032|
                  |L1.992|
;;;413        int xPos = 0;
0003e0  f04f0a00          MOV      r10,#0
;;;414        for (i = 0; i < (int)Index; i++) {
0003e4  4654              MOV      r4,r10
0003e6  e007              B        |L1.1016|
                  |L1.1000|
;;;415          xPos += _GetItemWidth(hObj, pObj, i);
0003e8  4622              MOV      r2,r4
0003ea  4641              MOV      r1,r8
0003ec  4658              MOV      r0,r11
0003ee  f7fffffe          BL       _GetItemWidth
0003f2  4482              ADD      r10,r10,r0
0003f4  f1040401          ADD      r4,r4,#1              ;414
                  |L1.1016|
0003f8  42b4              CMP      r4,r6                 ;414
0003fa  dbf5              BLT      |L1.1000|
;;;416        }
;;;417        *px = EffectSize + xPos;
0003fc  eb05000a          ADD      r0,r5,r10
000400  6038              STR      r0,[r7,#0]
;;;418        *py = EffectSize;
000402  f8c95000          STR      r5,[r9,#0]
;;;419      }
000406  bf00              NOP      
                  |L1.1032|
;;;420    }
000408  e8bd9ff0          POP      {r4-r12,pc}
;;;421    
                          ENDP

                  _SetCapture PROC
;;;425    */
;;;426    static void _SetCapture(MENU_Handle hObj, const MENU_Obj* pObj) {
00040c  b570              PUSH     {r4-r6,lr}
00040e  4605              MOV      r5,r0
000410  460c              MOV      r4,r1
;;;427      if (pObj->IsSubmenuActive == 0) {
000412  f8940060          LDRB     r0,[r4,#0x60]
000416  b938              CBNZ     r0,|L1.1064|
;;;428        if (WM_HasCaptured(hObj) == 0) {
000418  4628              MOV      r0,r5
00041a  f7fffffe          BL       WM_HasCaptured
00041e  b918              CBNZ     r0,|L1.1064|
;;;429          WM_SetCapture(hObj, 0);
000420  2100              MOVS     r1,#0
000422  4628              MOV      r0,r5
000424  f7fffffe          BL       WM_SetCapture
                  |L1.1064|
;;;430        }
;;;431      }
;;;432    }
000428  bd70              POP      {r4-r6,pc}
;;;433    
                          ENDP

                  _ReleaseCapture PROC
;;;437    */
;;;438    static void _ReleaseCapture(MENU_Handle hObj, const MENU_Obj* pObj) {
00042a  b570              PUSH     {r4-r6,lr}
00042c  4605              MOV      r5,r0
00042e  460c              MOV      r4,r1
;;;439      if (WM_HasCaptured(hObj)) {
000430  4628              MOV      r0,r5
000432  f7fffffe          BL       WM_HasCaptured
000436  b158              CBZ      r0,|L1.1104|
;;;440        if (_IsTopLevelMenu(hObj, pObj) && !(pObj->Flags & MENU_SF_POPUP)) {
000438  4621              MOV      r1,r4
00043a  4628              MOV      r0,r5
00043c  f7fffffe          BL       _IsTopLevelMenu
000440  b130              CBZ      r0,|L1.1104|
000442  f8b4005e          LDRH     r0,[r4,#0x5e]
000446  f0100f80          TST      r0,#0x80
00044a  d101              BNE      |L1.1104|
;;;441          WM_ReleaseCapture();
00044c  f7fffffe          BL       WM_ReleaseCapture
                  |L1.1104|
;;;442        }
;;;443      }
;;;444    }
000450  bd70              POP      {r4-r6,pc}
;;;445    
                          ENDP

                  MENU__InvalidateItem PROC
;;;1034   */
;;;1035   void MENU__InvalidateItem(MENU_Handle hObj, const MENU_Obj* pObj, unsigned Index) {
000452  b570              PUSH     {r4-r6,lr}
000454  4606              MOV      r6,r0
000456  460c              MOV      r4,r1
000458  4615              MOV      r5,r2
;;;1036     GUI_USE_PARA(pObj);
00045a  bf00              NOP      
;;;1037     GUI_USE_PARA(Index);
00045c  bf00              NOP      
;;;1038     WM_InvalidateWindow(hObj);  /* Can be optimized, no need to invalidate all items */
00045e  4630              MOV      r0,r6
000460  f7fffffe          BL       WM_InvalidateWindow
;;;1039   }
000464  bd70              POP      {r4-r6,pc}
;;;1040   
                          ENDP

                  _CloseSubmenu PROC
;;;449    */
;;;450    static void _CloseSubmenu(MENU_Handle hObj, MENU_Obj* pObj) {
000466  b570              PUSH     {r4-r6,lr}
000468  4606              MOV      r6,r0
00046a  460c              MOV      r4,r1
;;;451      if (pObj->Flags & MENU_SF_ACTIVE) {
00046c  f8b4005e          LDRH     r0,[r4,#0x5e]
000470  f0100f40          TST      r0,#0x40
000474  d023              BEQ      |L1.1214|
;;;452        if (pObj->IsSubmenuActive) {
000476  f8940060          LDRB     r0,[r4,#0x60]
00047a  b300              CBZ      r0,|L1.1214|
;;;453          MENU_ITEM* pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, pObj->Sel);
00047c  f1040058          ADD      r0,r4,#0x58
000480  6ee1              LDR      r1,[r4,#0x6c]
000482  f7fffffe          BL       GUI_ARRAY_GetpItem
000486  4605              MOV      r5,r0
;;;454          /* Inform submenu about its deactivation and detach it */
;;;455          MENU__SendMenuMessage(hObj, pItem->hSubmenu, MENU_ON_CLOSE, 0);
000488  f9b51000          LDRSH    r1,[r5,#0]
00048c  f04f0300          MOV      r3,#0
000490  f04f0204          MOV      r2,#4
000494  4630              MOV      r0,r6
000496  f7fffffe          BL       MENU__SendMenuMessage
;;;456          WM_DetachWindow(pItem->hSubmenu);
00049a  f9b50000          LDRSH    r0,[r5,#0]
00049e  f7fffffe          BL       WM_DetachWindow
;;;457          pObj->IsSubmenuActive = 0;
0004a2  f04f0000          MOV      r0,#0
0004a6  f8840060          STRB     r0,[r4,#0x60]
;;;458          /*
;;;459           * Keep capture in menu widget. The capture may only released
;;;460           * by clicking outside the menu or when mouse moved out.
;;;461           * And it may only released from a top level menu.
;;;462           */
;;;463          _SetCapture(hObj, pObj);
0004aa  4621              MOV      r1,r4
0004ac  4630              MOV      r0,r6
0004ae  f7fffffe          BL       _SetCapture
;;;464          /* Invalidate menu item. This is needed because the appearance may have changed */
;;;465          MENU__InvalidateItem(hObj, pObj, pObj->Sel);
0004b2  4621              MOV      r1,r4
0004b4  4630              MOV      r0,r6
0004b6  6ee2              LDR      r2,[r4,#0x6c]
0004b8  f7fffffe          BL       MENU__InvalidateItem
;;;466        }
0004bc  bf00              NOP      
                  |L1.1214|
;;;467      }
;;;468    }
0004be  bd70              POP      {r4-r6,pc}
;;;469    
                          ENDP

                  MENU_SetOwner PROC
;;;1162   */
;;;1163   void MENU_SetOwner(MENU_Handle hObj, WM_HWIN hOwner) {
0004c0  b570              PUSH     {r4-r6,lr}
0004c2  4604              MOV      r4,r0
0004c4  460d              MOV      r5,r1
;;;1164     if (hObj) {
0004c6  b13c              CBZ      r4,|L1.1240|
;;;1165       MENU_Obj* pObj;
;;;1166       WM_LOCK();
;;;1167       pObj = MENU_H2P(hObj);
0004c8  4620              MOV      r0,r4
0004ca  f7fffffe          BL       GUI_ALLOC_h2p
0004ce  4606              MOV      r6,r0
;;;1168       if (pObj) {
0004d0  b10e              CBZ      r6,|L1.1238|
;;;1169         pObj->hOwner = hOwner;
0004d2  f8a6505c          STRH     r5,[r6,#0x5c]
                  |L1.1238|
;;;1170       }
;;;1171       WM_UNLOCK();
;;;1172     }
0004d6  bf00              NOP      
                  |L1.1240|
;;;1173   }
0004d8  bd70              POP      {r4-r6,pc}
;;;1174   
                          ENDP

                  _OpenSubmenu PROC
;;;473    */
;;;474    static void _OpenSubmenu(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index) {
0004da  e92d4ffe          PUSH     {r1-r11,lr}
0004de  4606              MOV      r6,r0
0004e0  460c              MOV      r4,r1
0004e2  4617              MOV      r7,r2
;;;475      if (pObj->Flags & MENU_SF_ACTIVE) {
0004e4  f8b4005e          LDRH     r0,[r4,#0x5e]
0004e8  f0100f40          TST      r0,#0x40
0004ec  d07e              BEQ      |L1.1516|
;;;476        MENU_ITEM* pItem;
;;;477        char PrevActiveSubmenu;
;;;478        PrevActiveSubmenu = pObj->IsSubmenuActive;
0004ee  f8949060          LDRB     r9,[r4,#0x60]
;;;479        /* Close previous submenu (if needed) */
;;;480        _CloseSubmenu(hObj, pObj);
0004f2  4621              MOV      r1,r4
0004f4  4630              MOV      r0,r6
0004f6  f7fffffe          BL       _CloseSubmenu
;;;481        pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
0004fa  4639              MOV      r1,r7
0004fc  f1040058          ADD      r0,r4,#0x58
000500  f7fffffe          BL       GUI_ARRAY_GetpItem
000504  4605              MOV      r5,r0
;;;482        if (pItem->hSubmenu) {
000506  8828              LDRH     r0,[r5,#0]
000508  2800              CMP      r0,#0
00050a  d07f              BEQ      |L1.1548|
;;;483          if ((pItem->Flags & MENU_IF_DISABLED) == 0) {
00050c  88a8              LDRH     r0,[r5,#4]
00050e  f0100f01          TST      r0,#1
000512  d17b              BNE      |L1.1548|
;;;484            int x, y, EffectSize;
;;;485            /* Calculate position of submenu */
;;;486            EffectSize = _GetEffectSize(hObj, pObj);
000514  4621              MOV      r1,r4
000516  4630              MOV      r0,r6
000518  f7fffffe          BL       _GetEffectSize
00051c  4680              MOV      r8,r0
;;;487            _GetItemPos(hObj, pObj, Index, &x, &y);
00051e  a801              ADD      r0,sp,#4
000520  ab02              ADD      r3,sp,#8
000522  463a              MOV      r2,r7
000524  4621              MOV      r1,r4
000526  9000              STR      r0,[sp,#0]
000528  4630              MOV      r0,r6
00052a  f7fffffe          BL       _GetItemPos
;;;488            if (pObj->Flags & MENU_SF_VERTICAL) {
00052e  f8b4005e          LDRH     r0,[r4,#0x5e]
000532  f0100f01          TST      r0,#1
000536  d012              BEQ      |L1.1374|
;;;489              x += _CalcMenuSizeX(hObj, pObj) - (_GetEffectSize(hObj, pObj) << 1);
000538  4621              MOV      r1,r4
00053a  4630              MOV      r0,r6
00053c  f7fffffe          BL       _CalcMenuSizeX
000540  4682              MOV      r10,r0
000542  4621              MOV      r1,r4
000544  4630              MOV      r0,r6
000546  f7fffffe          BL       _GetEffectSize
00054a  ebaa0040          SUB      r0,r10,r0,LSL #1
00054e  9902              LDR      r1,[sp,#8]
000550  4408              ADD      r0,r0,r1
000552  9002              STR      r0,[sp,#8]
;;;490              y -= EffectSize;
000554  9801              LDR      r0,[sp,#4]
000556  eba00008          SUB      r0,r0,r8
00055a  9001              STR      r0,[sp,#4]
00055c  e011              B        |L1.1410|
                  |L1.1374|
;;;491            } else {
;;;492              y += _CalcMenuSizeY(hObj, pObj) - (_GetEffectSize(hObj, pObj) << 1);
00055e  4621              MOV      r1,r4
000560  4630              MOV      r0,r6
000562  f7fffffe          BL       _CalcMenuSizeY
000566  4682              MOV      r10,r0
000568  4621              MOV      r1,r4
00056a  4630              MOV      r0,r6
00056c  f7fffffe          BL       _GetEffectSize
000570  ebaa0040          SUB      r0,r10,r0,LSL #1
000574  9901              LDR      r1,[sp,#4]
000576  4408              ADD      r0,r0,r1
000578  9001              STR      r0,[sp,#4]
;;;493              x -= EffectSize;
00057a  9802              LDR      r0,[sp,#8]
00057c  eba00008          SUB      r0,r0,r8
000580  9002              STR      r0,[sp,#8]
                  |L1.1410|
;;;494            }
;;;495            x += WM_GetWindowOrgX(hObj);
000582  4630              MOV      r0,r6
000584  f7fffffe          BL       WM_GetWindowOrgX
000588  9902              LDR      r1,[sp,#8]
00058a  4408              ADD      r0,r0,r1
00058c  9002              STR      r0,[sp,#8]
;;;496            y += WM_GetWindowOrgY(hObj);
00058e  4630              MOV      r0,r6
000590  f7fffffe          BL       WM_GetWindowOrgY
000594  9901              LDR      r1,[sp,#4]
000596  4408              ADD      r0,r0,r1
000598  9001              STR      r0,[sp,#4]
;;;497            /*
;;;498             * Notify owner window when for the first time open a menu (when no
;;;499             * other submenu was open), so it can initialize the menu items.
;;;500             */
;;;501            if (PrevActiveSubmenu == 0) {
00059a  f1b90f00          CMP      r9,#0
00059e  d10b              BNE      |L1.1464|
;;;502              if (_IsTopLevelMenu(hObj, pObj)) {
0005a0  4621              MOV      r1,r4
0005a2  4630              MOV      r0,r6
0005a4  f7fffffe          BL       _IsTopLevelMenu
0005a8  b130              CBZ      r0,|L1.1464|
;;;503                MENU__SendMenuMessage(hObj, pObj->hOwner, MENU_ON_INITMENU, 0);
0005aa  f9b4105c          LDRSH    r1,[r4,#0x5c]
0005ae  2300              MOVS     r3,#0
0005b0  2201              MOVS     r2,#1
0005b2  4630              MOV      r0,r6
0005b4  f7fffffe          BL       MENU__SendMenuMessage
                  |L1.1464|
;;;504              }
;;;505            }
;;;506            /* Notify owner window when a submenu opens, so it can initialize the menu items. */
;;;507            MENU__SendMenuMessage(hObj, pObj->hOwner, MENU_ON_INITSUBMENU, pItem->Id);
0005b8  886b              LDRH     r3,[r5,#2]
0005ba  f9b4105c          LDRSH    r1,[r4,#0x5c]
0005be  2202              MOVS     r2,#2
0005c0  4630              MOV      r0,r6
0005c2  f7fffffe          BL       MENU__SendMenuMessage
;;;508            /* Set active menu as owner of submenu. */
;;;509            MENU_SetOwner(pItem->hSubmenu, hObj);
0005c6  f9b50000          LDRSH    r0,[r5,#0]
0005ca  4631              MOV      r1,r6
0005cc  f7fffffe          BL       MENU_SetOwner
;;;510            /* Attach submenu and inform it about its activation. */
;;;511            WM_AttachWindowAt(pItem->hSubmenu, WM_HBKWIN, x, y);
0005d0  f7fffffe          BL       WM_GetDesktopWindow
0005d4  4682              MOV      r10,r0
0005d6  f9b50000          LDRSH    r0,[r5,#0]
0005da  4651              MOV      r1,r10
0005dc  e9dd3201          LDRD     r3,r2,[sp,#4]
0005e0  f7fffffe          BL       WM_AttachWindowAt
;;;512            MENU__SendMenuMessage(hObj, pItem->hSubmenu, MENU_ON_OPEN, 0);
0005e4  f9b51000          LDRSH    r1,[r5,#0]
0005e8  2300              MOVS     r3,#0
0005ea  e001              B        |L1.1520|
                  |L1.1516|
0005ec  e00f              B        |L1.1550|
0005ee  e00d              B        |L1.1548|
                  |L1.1520|
0005f0  2203              MOVS     r2,#3
0005f2  4630              MOV      r0,r6
0005f4  f7fffffe          BL       MENU__SendMenuMessage
;;;513            pObj->IsSubmenuActive = 1;
0005f8  f04f0001          MOV      r0,#1
0005fc  f8840060          STRB     r0,[r4,#0x60]
;;;514            /* Invalidate menu item. This is needed because the appearance may have changed. */
;;;515            MENU__InvalidateItem(hObj, pObj, Index);
000600  463a              MOV      r2,r7
000602  4621              MOV      r1,r4
000604  4630              MOV      r0,r6
000606  f7fffffe          BL       MENU__InvalidateItem
;;;516          }
00060a  bf00              NOP      
                  |L1.1548|
;;;517        }
;;;518      }
00060c  bf00              NOP      
                  |L1.1550|
;;;519    }
00060e  e8bd8ffe          POP      {r1-r11,pc}
;;;520    
                          ENDP

                  _ClosePopup PROC
;;;524    */
;;;525    static void _ClosePopup(MENU_Handle hObj, MENU_Obj* pObj) {
000612  b570              PUSH     {r4-r6,lr}
000614  4605              MOV      r5,r0
000616  460c              MOV      r4,r1
;;;526      if (pObj->Flags & MENU_SF_POPUP) {
000618  f8b4005e          LDRH     r0,[r4,#0x5e]
00061c  f0100f80          TST      r0,#0x80
000620  d00a              BEQ      |L1.1592|
;;;527        pObj->Flags &= ~(MENU_SF_POPUP);
000622  f8b4005e          LDRH     r0,[r4,#0x5e]
000626  f0200080          BIC      r0,r0,#0x80
00062a  f8a4005e          STRH     r0,[r4,#0x5e]
;;;528        WM_DetachWindow(hObj);
00062e  4628              MOV      r0,r5
000630  f7fffffe          BL       WM_DetachWindow
;;;529        WM_ReleaseCapture();
000634  f7fffffe          BL       WM_ReleaseCapture
                  |L1.1592|
;;;530      }
;;;531    }
000638  bd70              POP      {r4-r6,pc}
;;;532    
                          ENDP

                  _SetSelection PROC
;;;536    */
;;;537    static void _SetSelection(MENU_Handle hObj, MENU_Obj* pObj, int Index) {
00063a  b570              PUSH     {r4-r6,lr}
00063c  4606              MOV      r6,r0
00063e  460c              MOV      r4,r1
000640  4615              MOV      r5,r2
;;;538      if (Index != pObj->Sel) {
000642  6ee0              LDR      r0,[r4,#0x6c]
000644  42a8              CMP      r0,r5
000646  d00a              BEQ      |L1.1630|
;;;539        MENU__InvalidateItem(hObj, pObj, pObj->Sel); /* Invalidate previous selection */
000648  4621              MOV      r1,r4
00064a  4630              MOV      r0,r6
00064c  6ee2              LDR      r2,[r4,#0x6c]
00064e  f7fffffe          BL       MENU__InvalidateItem
;;;540        MENU__InvalidateItem(hObj, pObj, Index);     /* Invalidate new selection */
000652  462a              MOV      r2,r5
000654  4621              MOV      r1,r4
000656  4630              MOV      r0,r6
000658  f7fffffe          BL       MENU__InvalidateItem
;;;541        pObj->Sel = Index;
00065c  66e5              STR      r5,[r4,#0x6c]
                  |L1.1630|
;;;542      }
;;;543    }
00065e  bd70              POP      {r4-r6,pc}
;;;544    
                          ENDP

                  _SelectItem PROC
;;;548    */
;;;549    static void _SelectItem(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index) {
000660  b570              PUSH     {r4-r6,lr}
000662  4606              MOV      r6,r0
000664  460c              MOV      r4,r1
000666  4615              MOV      r5,r2
;;;550      if (pObj->Sel != (int)Index) {
000668  6ee0              LDR      r0,[r4,#0x6c]
00066a  42a8              CMP      r0,r5
00066c  d00d              BEQ      |L1.1674|
;;;551        _SetCapture(hObj, pObj);
00066e  4621              MOV      r1,r4
000670  4630              MOV      r0,r6
000672  f7fffffe          BL       _SetCapture
;;;552        _OpenSubmenu(hObj, pObj, Index);
000676  462a              MOV      r2,r5
000678  4621              MOV      r1,r4
00067a  4630              MOV      r0,r6
00067c  f7fffffe          BL       _OpenSubmenu
;;;553        _SetSelection(hObj, pObj, Index);
000680  462a              MOV      r2,r5
000682  4621              MOV      r1,r4
000684  4630              MOV      r0,r6
000686  f7fffffe          BL       _SetSelection
                  |L1.1674|
;;;554      }
;;;555    }
00068a  bd70              POP      {r4-r6,pc}
;;;556    
                          ENDP

                  _DeselectItem PROC
;;;560    */
;;;561    static void _DeselectItem(MENU_Handle hObj, MENU_Obj* pObj) {
00068c  b570              PUSH     {r4-r6,lr}
00068e  4605              MOV      r5,r0
000690  460c              MOV      r4,r1
;;;562      if (pObj->IsSubmenuActive == 0) {
000692  f8940060          LDRB     r0,[r4,#0x60]
000696  b948              CBNZ     r0,|L1.1708|
;;;563        _SetSelection(hObj, pObj, -1);
000698  f04f32ff          MOV      r2,#0xffffffff
00069c  4621              MOV      r1,r4
00069e  4628              MOV      r0,r5
0006a0  f7fffffe          BL       _SetSelection
;;;564        _ReleaseCapture(hObj, pObj);
0006a4  4621              MOV      r1,r4
0006a6  4628              MOV      r0,r5
0006a8  f7fffffe          BL       _ReleaseCapture
                  |L1.1708|
;;;565      }
;;;566    }
0006ac  bd70              POP      {r4-r6,pc}
;;;567    
                          ENDP

                  _ActivateItem PROC
;;;571    */
;;;572    static void _ActivateItem(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index) {
0006ae  e92d41f0          PUSH     {r4-r8,lr}
0006b2  4607              MOV      r7,r0
0006b4  460c              MOV      r4,r1
0006b6  4616              MOV      r6,r2
;;;573      MENU_ITEM* pItem;
;;;574      pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
0006b8  4631              MOV      r1,r6
0006ba  f1040058          ADD      r0,r4,#0x58
0006be  f7fffffe          BL       GUI_ARRAY_GetpItem
0006c2  4605              MOV      r5,r0
;;;575      if (pItem->hSubmenu == 0) {
0006c4  8828              LDRH     r0,[r5,#0]
0006c6  b970              CBNZ     r0,|L1.1766|
;;;576        if ((pItem->Flags & (MENU_IF_DISABLED | MENU_IF_SEPARATOR)) == 0) {
0006c8  88a8              LDRH     r0,[r5,#4]
0006ca  f0100f03          TST      r0,#3
0006ce  d10a              BNE      |L1.1766|
;;;577          _ClosePopup(hObj, pObj);
0006d0  4621              MOV      r1,r4
0006d2  4638              MOV      r0,r7
0006d4  f7fffffe          BL       _ClosePopup
;;;578          /* Send item select message to owner. */
;;;579          MENU__SendMenuMessage(hObj, pObj->hOwner, MENU_ON_ITEMSELECT, pItem->Id);
0006d8  886b              LDRH     r3,[r5,#2]
0006da  f9b4105c          LDRSH    r1,[r4,#0x5c]
0006de  2200              MOVS     r2,#0
0006e0  4638              MOV      r0,r7
0006e2  f7fffffe          BL       MENU__SendMenuMessage
                  |L1.1766|
;;;580        }
;;;581      }
;;;582    }
0006e6  e8bd81f0          POP      {r4-r8,pc}
;;;583    
                          ENDP

                  _ActivateMenu PROC
;;;587    */
;;;588    static void _ActivateMenu(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index) {
0006ea  e92d41f0          PUSH     {r4-r8,lr}
0006ee  4607              MOV      r7,r0
0006f0  460c              MOV      r4,r1
0006f2  4615              MOV      r5,r2
;;;589      if ((pObj->Flags & MENU_SF_OPEN_ON_POINTEROVER) == 0) {
0006f4  f8b4005e          LDRH     r0,[r4,#0x5e]
0006f8  f0100f02          TST      r0,#2
0006fc  d134              BNE      |L1.1896|
;;;590        MENU_ITEM* pItem;
;;;591        pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
0006fe  4629              MOV      r1,r5
000700  f1040058          ADD      r0,r4,#0x58
000704  f7fffffe          BL       GUI_ARRAY_GetpItem
000708  4606              MOV      r6,r0
;;;592        if (pItem->hSubmenu) {
00070a  8830              LDRH     r0,[r6,#0]
00070c  b358              CBZ      r0,|L1.1894|
;;;593          if ((pItem->Flags & MENU_IF_DISABLED) == 0) {
00070e  88b0              LDRH     r0,[r6,#4]
000710  f0100f01          TST      r0,#1
000714  d127              BNE      |L1.1894|
;;;594            if ((pObj->Flags & MENU_SF_ACTIVE) == 0) {
000716  f8b4005e          LDRH     r0,[r4,#0x5e]
00071a  f0100f40          TST      r0,#0x40
00071e  d110              BNE      |L1.1858|
;;;595              pObj->Flags |= MENU_SF_ACTIVE;
000720  f8b4005e          LDRH     r0,[r4,#0x5e]
000724  f0400040          ORR      r0,r0,#0x40
000728  f8a4005e          STRH     r0,[r4,#0x5e]
;;;596              _OpenSubmenu(hObj, pObj, Index);
00072c  462a              MOV      r2,r5
00072e  4621              MOV      r1,r4
000730  4638              MOV      r0,r7
000732  f7fffffe          BL       _OpenSubmenu
;;;597              _SetSelection(hObj, pObj, Index);
000736  462a              MOV      r2,r5
000738  4621              MOV      r1,r4
00073a  4638              MOV      r0,r7
00073c  f7fffffe          BL       _SetSelection
000740  e011              B        |L1.1894|
                  |L1.1858|
;;;598            } else if (pObj->Flags & MENU_SF_CLOSE_ON_SECOND_CLICK) {
000742  f8b4005e          LDRH     r0,[r4,#0x5e]
000746  f0100f04          TST      r0,#4
00074a  d00c              BEQ      |L1.1894|
;;;599              if ((int)Index == pObj->Sel) {
00074c  6ee0              LDR      r0,[r4,#0x6c]
00074e  42a8              CMP      r0,r5
000750  d109              BNE      |L1.1894|
;;;600                _CloseSubmenu(hObj, pObj);
000752  4621              MOV      r1,r4
000754  4638              MOV      r0,r7
000756  f7fffffe          BL       _CloseSubmenu
;;;601                pObj->Flags &= ~MENU_SF_ACTIVE;
00075a  f8b4005e          LDRH     r0,[r4,#0x5e]
00075e  f0200040          BIC      r0,r0,#0x40
000762  f8a4005e          STRH     r0,[r4,#0x5e]
                  |L1.1894|
;;;602              }
;;;603            }
;;;604          }
;;;605        }
;;;606      }
000766  bf00              NOP      
                  |L1.1896|
;;;607    }
000768  e8bd81f0          POP      {r4-r8,pc}
;;;608    
                          ENDP

                  _DeactivateMenu PROC
;;;612    */
;;;613    static void _DeactivateMenu(MENU_Handle hObj, MENU_Obj* pObj) {
00076c  b570              PUSH     {r4-r6,lr}
00076e  4605              MOV      r5,r0
000770  460c              MOV      r4,r1
;;;614      _CloseSubmenu(hObj, pObj);
000772  4621              MOV      r1,r4
000774  4628              MOV      r0,r5
000776  f7fffffe          BL       _CloseSubmenu
;;;615      if ((pObj->Flags & MENU_SF_OPEN_ON_POINTEROVER) == 0) {
00077a  f8b4005e          LDRH     r0,[r4,#0x5e]
00077e  f0100f02          TST      r0,#2
000782  d105              BNE      |L1.1936|
;;;616        pObj->Flags &= ~MENU_SF_ACTIVE;
000784  f8b4005e          LDRH     r0,[r4,#0x5e]
000788  f0200040          BIC      r0,r0,#0x40
00078c  f8a4005e          STRH     r0,[r4,#0x5e]
                  |L1.1936|
;;;617      }
;;;618    }
000790  bd70              POP      {r4-r6,pc}
;;;619    
                          ENDP

                  _ForwardMouseOverMsg PROC
;;;623    */
;;;624    static int _ForwardMouseOverMsg(MENU_Handle hObj, MENU_Obj* pObj, int x, int y) {
000792  b510              PUSH     {r4,lr}
000794  4604              MOV      r4,r0
;;;625    #if (GUI_SUPPORT_MOUSE)
;;;626      if ((pObj->IsSubmenuActive == 0) && !(pObj->Flags & MENU_SF_POPUP)) {
;;;627        if (_IsTopLevelMenu(hObj, pObj)) {
;;;628          WM_HWIN hBelow;
;;;629          x += WM_GetWindowOrgX(hObj);
;;;630          y += WM_GetWindowOrgY(hObj);
;;;631          hBelow = WM_Screen2hWin(x, y);
;;;632          if (hBelow && (hBelow != hObj)) {
;;;633            WM_MESSAGE Msg;
;;;634            GUI_PID_STATE State;
;;;635            x -= WM_GetWindowOrgX(hBelow);
;;;636            y -= WM_GetWindowOrgY(hBelow);
;;;637            State.Pressed = 0;
;;;638            State.x = x;
;;;639            State.y = y;
;;;640            Msg.Data.p = &State;
;;;641            Msg.MsgId = WM_MOUSEOVER;
;;;642            WM__SendMessage(hBelow, &Msg);
;;;643            return 1;
;;;644          }
;;;645        }
;;;646      }
;;;647    #endif
;;;648      return 0;
000796  f04f0000          MOV      r0,#0
;;;649    }
00079a  bd10              POP      {r4,pc}
;;;650    
                          ENDP

                  _HandlePID PROC
;;;658    */
;;;659    static char _HandlePID(MENU_Handle hObj, MENU_Obj* pObj, int x, int y, int Pressed) {
00079c  e92d47f0          PUSH     {r4-r10,lr}
0007a0  b086              SUB      sp,sp,#0x18
0007a2  4681              MOV      r9,r0
0007a4  460f              MOV      r7,r1
0007a6  4615              MOV      r5,r2
0007a8  461e              MOV      r6,r3
0007aa  9c0e              LDR      r4,[sp,#0x38]
;;;660      GUI_PID_STATE PrevState;
;;;661      char XYInWidget = 0;
0007ac  f04f0a00          MOV      r10,#0
;;;662      WM_PID__GetPrevState(&PrevState);
0007b0  a803              ADD      r0,sp,#0xc
0007b2  f7fffffe          BL       WM_PID__GetPrevState
;;;663      /*
;;;664       * Check if coordinates are inside the widget.
;;;665       */
;;;666      if ((x >= 0) && (y >= 0)) {
0007b6  2d00              CMP      r5,#0
0007b8  db10              BLT      |L1.2012|
0007ba  2e00              CMP      r6,#0
0007bc  db0e              BLT      |L1.2012|
;;;667        GUI_RECT r;
;;;668        WM__GetClientRectWin(&pObj->Widget.Win, &r);
0007be  a901              ADD      r1,sp,#4
0007c0  4638              MOV      r0,r7
0007c2  f7fffffe          BL       WM__GetClientRectWin
;;;669        if ((x <= r.x1) && (y <= r.y1)) {
0007c6  f9bd0008          LDRSH    r0,[sp,#8]
0007ca  42a8              CMP      r0,r5
0007cc  db05              BLT      |L1.2010|
0007ce  f9bd000a          LDRSH    r0,[sp,#0xa]
0007d2  42b0              CMP      r0,r6
0007d4  db01              BLT      |L1.2010|
;;;670          XYInWidget = 1;
0007d6  f04f0a01          MOV      r10,#1
                  |L1.2010|
;;;671        }
;;;672      }
0007da  bf00              NOP      
                  |L1.2012|
;;;673    
;;;674      if (XYInWidget) {
0007dc  f1ba0f00          CMP      r10,#0
0007e0  d050              BEQ      |L1.2180|
;;;675        int ItemIndex;
;;;676        ItemIndex = _GetItemFromPos(hObj, pObj, x, y);
0007e2  4633              MOV      r3,r6
0007e4  462a              MOV      r2,r5
0007e6  4639              MOV      r1,r7
0007e8  4648              MOV      r0,r9
0007ea  f7fffffe          BL       _GetItemFromPos
0007ee  4680              MOV      r8,r0
;;;677        /* 
;;;678         * Handle PID when coordinates are inside the widget.
;;;679         */
;;;680        if (ItemIndex >= 0) {
0007f0  f1b80f00          CMP      r8,#0
0007f4  db2e              BLT      |L1.2132|
;;;681          /* 
;;;682           * Coordinates are inside the menu.
;;;683           */
;;;684          if (Pressed == 1) {
0007f6  2c01              CMP      r4,#1
0007f8  d10d              BNE      |L1.2070|
;;;685            if (PrevState.Pressed == 0) {  /* Clicked */
0007fa  f89d0014          LDRB     r0,[sp,#0x14]
0007fe  b920              CBNZ     r0,|L1.2058|
;;;686              _ActivateMenu(hObj, pObj, ItemIndex);
000800  4642              MOV      r2,r8
000802  4639              MOV      r1,r7
000804  4648              MOV      r0,r9
000806  f7fffffe          BL       _ActivateMenu
                  |L1.2058|
;;;687            }
;;;688            _SelectItem(hObj, pObj, ItemIndex);
00080a  4642              MOV      r2,r8
00080c  4639              MOV      r1,r7
00080e  4648              MOV      r0,r9
000810  f7fffffe          BL       _SelectItem
000814  e032              B        |L1.2172|
                  |L1.2070|
;;;689          } else if ((Pressed == 0) && (PrevState.Pressed == 1)) {  /* Released */
000816  b94c              CBNZ     r4,|L1.2092|
000818  f89d0014          LDRB     r0,[sp,#0x14]
00081c  2801              CMP      r0,#1
00081e  d105              BNE      |L1.2092|
;;;690            _ActivateItem(hObj, pObj, ItemIndex);
000820  4642              MOV      r2,r8
000822  4639              MOV      r1,r7
000824  4648              MOV      r0,r9
000826  f7fffffe          BL       _ActivateItem
00082a  e027              B        |L1.2172|
                  |L1.2092|
;;;691          } else if (Pressed < 0) {  /* Mouse moved */
00082c  2c00              CMP      r4,#0
00082e  da25              BGE      |L1.2172|
;;;692            if (_ForwardMouseOverMsg(hObj, pObj, x, y) == 0) {
000830  4633              MOV      r3,r6
000832  462a              MOV      r2,r5
000834  4639              MOV      r1,r7
000836  4648              MOV      r0,r9
000838  f7fffffe          BL       _ForwardMouseOverMsg
00083c  b928              CBNZ     r0,|L1.2122|
;;;693              _SelectItem(hObj, pObj, ItemIndex);
00083e  4642              MOV      r2,r8
000840  4639              MOV      r1,r7
000842  4648              MOV      r0,r9
000844  f7fffffe          BL       _SelectItem
000848  e018              B        |L1.2172|
                  |L1.2122|
;;;694            } else {
;;;695              _DeselectItem(hObj, pObj);
00084a  4639              MOV      r1,r7
00084c  4648              MOV      r0,r9
00084e  f7fffffe          BL       _DeselectItem
000852  e013              B        |L1.2172|
                  |L1.2132|
;;;696            }
;;;697          }
;;;698        } else {
;;;699          /* 
;;;700           * Coordinates are outside the menu but inside the widget.
;;;701           */
;;;702          if (Pressed == 1) {
000854  2c01              CMP      r4,#1
000856  d10b              BNE      |L1.2160|
;;;703            if (PrevState.Pressed == 0) {  /* Clicked */
000858  f89d0014          LDRB     r0,[sp,#0x14]
00085c  b918              CBNZ     r0,|L1.2150|
;;;704              /* 
;;;705               * User has clicked outside the menu. Close the active submenu.
;;;706               * The widget itself must be closed (if needed) by the owner.
;;;707               */
;;;708              _DeactivateMenu(hObj, pObj);
00085e  4639              MOV      r1,r7
000860  4648              MOV      r0,r9
000862  f7fffffe          BL       _DeactivateMenu
                  |L1.2150|
;;;709            }
;;;710            _DeselectItem(hObj, pObj);
000866  4639              MOV      r1,r7
000868  4648              MOV      r0,r9
00086a  f7fffffe          BL       _DeselectItem
00086e  e005              B        |L1.2172|
                  |L1.2160|
;;;711          } else if (Pressed < 0) {  /* Moved out or mouse moved */
000870  2c00              CMP      r4,#0
000872  da03              BGE      |L1.2172|
;;;712            _DeselectItem(hObj, pObj);
000874  4639              MOV      r1,r7
000876  4648              MOV      r0,r9
000878  f7fffffe          BL       _DeselectItem
                  |L1.2172|
;;;713          }
;;;714        }
;;;715        return 0;
00087c  2000              MOVS     r0,#0
                  |L1.2174|
;;;716      } else {
;;;717        /* 
;;;718         * Handle PID when coordinates are outside the widget.
;;;719         */
;;;720        if ((Pressed == 1) && (PrevState.Pressed == 0)) {
;;;721          /* 
;;;722           * User has clicked outside the menu. Close the active submenu.
;;;723           * The widget itself must be closed (if needed) by the owner.
;;;724           */
;;;725          _DeactivateMenu(hObj, pObj);
;;;726          _ClosePopup(hObj, pObj);
;;;727        }
;;;728        _DeselectItem(hObj, pObj);
;;;729        _ForwardMouseOverMsg(hObj, pObj, x, y);
;;;730      }
;;;731      return 1;   /* Coordinates are not in widget, we need to forward PID message to owner */
;;;732    }
00087e  b006              ADD      sp,sp,#0x18
000880  e8bd87f0          POP      {r4-r10,pc}
                  |L1.2180|
000884  2c01              CMP      r4,#1                 ;720
000886  d10a              BNE      |L1.2206|
000888  f89d0014          LDRB     r0,[sp,#0x14]         ;720
00088c  b938              CBNZ     r0,|L1.2206|
00088e  4639              MOV      r1,r7                 ;725
000890  4648              MOV      r0,r9                 ;725
000892  f7fffffe          BL       _DeactivateMenu
000896  4639              MOV      r1,r7                 ;726
000898  4648              MOV      r0,r9                 ;726
00089a  f7fffffe          BL       _ClosePopup
                  |L1.2206|
00089e  4639              MOV      r1,r7                 ;728
0008a0  4648              MOV      r0,r9                 ;728
0008a2  f7fffffe          BL       _DeselectItem
0008a6  4633              MOV      r3,r6                 ;729
0008a8  462a              MOV      r2,r5                 ;729
0008aa  4639              MOV      r1,r7                 ;729
0008ac  4648              MOV      r0,r9                 ;729
0008ae  f7fffffe          BL       _ForwardMouseOverMsg
0008b2  2001              MOVS     r0,#1                 ;731
0008b4  e7e3              B        |L1.2174|
;;;733    
                          ENDP

                  _ForwardPIDMsgToOwner PROC
;;;737    */
;;;738    static void _ForwardPIDMsgToOwner(MENU_Handle hObj, MENU_Obj* pObj, WM_MESSAGE* pMsg) {
0008b6  e92d47f0          PUSH     {r4-r10,lr}
0008ba  4680              MOV      r8,r0
0008bc  460e              MOV      r6,r1
0008be  4614              MOV      r4,r2
;;;739      if (_IsTopLevelMenu(hObj, pObj) == 0) {
0008c0  4631              MOV      r1,r6
0008c2  4640              MOV      r0,r8
0008c4  f7fffffe          BL       _IsTopLevelMenu
0008c8  bb58              CBNZ     r0,|L1.2338|
;;;740        WM_HWIN hOwner;
;;;741        hOwner = pObj->hOwner ? pObj->hOwner : WM_GetParent(hObj);
0008ca  f8b6005c          LDRH     r0,[r6,#0x5c]
0008ce  b110              CBZ      r0,|L1.2262|
0008d0  f9b6005c          LDRSH    r0,[r6,#0x5c]
0008d4  e002              B        |L1.2268|
                  |L1.2262|
0008d6  4640              MOV      r0,r8
0008d8  f7fffffe          BL       WM_GetParent
                  |L1.2268|
0008dc  4607              MOV      r7,r0
;;;742        if (hOwner) {
0008de  b1ff              CBZ      r7,|L1.2336|
;;;743          if (pMsg->Data.p) {
0008e0  68a0              LDR      r0,[r4,#8]
0008e2  b1c8              CBZ      r0,|L1.2328|
;;;744            GUI_PID_STATE* pState;
;;;745            pState = (GUI_PID_STATE*)pMsg->Data.p;
0008e4  68a5              LDR      r5,[r4,#8]
;;;746            pState->x += WM_GetWindowOrgX(hObj) - WM_GetWindowOrgX(hOwner);
0008e6  4640              MOV      r0,r8
0008e8  f7fffffe          BL       WM_GetWindowOrgX
0008ec  4681              MOV      r9,r0
0008ee  4638              MOV      r0,r7
0008f0  f7fffffe          BL       WM_GetWindowOrgX
0008f4  eba90000          SUB      r0,r9,r0
0008f8  6829              LDR      r1,[r5,#0]
0008fa  4408              ADD      r0,r0,r1
0008fc  6028              STR      r0,[r5,#0]
;;;747            pState->y += WM_GetWindowOrgY(hObj) - WM_GetWindowOrgY(hOwner);
0008fe  4640              MOV      r0,r8
000900  f7fffffe          BL       WM_GetWindowOrgY
000904  4681              MOV      r9,r0
000906  4638              MOV      r0,r7
000908  f7fffffe          BL       WM_GetWindowOrgY
00090c  eba90000          SUB      r0,r9,r0
000910  6869              LDR      r1,[r5,#4]
000912  4408              ADD      r0,r0,r1
000914  6068              STR      r0,[r5,#4]
;;;748          }
000916  bf00              NOP      
                  |L1.2328|
;;;749          WM__SendMessage(hOwner, pMsg);
000918  4621              MOV      r1,r4
00091a  4638              MOV      r0,r7
00091c  f7fffffe          BL       WM__SendMessage
                  |L1.2336|
;;;750        }
;;;751      }
000920  bf00              NOP      
                  |L1.2338|
;;;752    }
000922  e8bd87f0          POP      {r4-r10,pc}
;;;753    
                          ENDP

                  MENU__ResizeMenu PROC
;;;1061   */
;;;1062   void MENU__ResizeMenu(MENU_Handle hObj, MENU_Obj* pObj) {
000926  e92d41f0          PUSH     {r4-r8,lr}
00092a  4604              MOV      r4,r0
00092c  460d              MOV      r5,r1
;;;1063     int xSize, ySize;
;;;1064     xSize = _CalcWindowSizeX(hObj, pObj);
00092e  4629              MOV      r1,r5
000930  4620              MOV      r0,r4
000932  f7fffffe          BL       _CalcWindowSizeX
000936  4606              MOV      r6,r0
;;;1065     ySize = _CalcWindowSizeY(hObj, pObj);
000938  4629              MOV      r1,r5
00093a  4620              MOV      r0,r4
00093c  f7fffffe          BL       _CalcWindowSizeY
000940  4607              MOV      r7,r0
;;;1066     WM_SetSize(hObj, xSize, ySize);
000942  463a              MOV      r2,r7
000944  4631              MOV      r1,r6
000946  4620              MOV      r0,r4
000948  f7fffffe          BL       WM_SetSize
;;;1067     WM_InvalidateWindow(hObj);
00094c  4620              MOV      r0,r4
00094e  f7fffffe          BL       WM_InvalidateWindow
;;;1068   }
000952  e8bd81f0          POP      {r4-r8,pc}
;;;1069   
                          ENDP

                  _OnMenu PROC
;;;763    */
;;;764    static void _OnMenu(MENU_Handle hObj, MENU_Obj* pObj, WM_MESSAGE* pMsg) {
000956  e92d41f0          PUSH     {r4-r8,lr}
00095a  4606              MOV      r6,r0
00095c  460c              MOV      r4,r1
00095e  4615              MOV      r5,r2
;;;765      const MENU_MSG_DATA* pData = (const MENU_MSG_DATA*)pMsg->Data.p;
000960  68af              LDR      r7,[r5,#8]
;;;766      if (pData) {
000962  2f00              CMP      r7,#0
000964  d049              BEQ      |L1.2554|
;;;767        switch (pData->MsgType) {
000966  8838              LDRH     r0,[r7,#0]
000968  2806              CMP      r0,#6
00096a  d245              BCS      |L1.2552|
00096c  e8dff000          TBB      [pc,r0]
000970  03101124          DCB      0x03,0x10,0x11,0x24
000974  3b40              DCB      0x3b,0x40
;;;768        case MENU_ON_ITEMSELECT:
;;;769          _DeactivateMenu(hObj, pObj);
000976  4621              MOV      r1,r4
000978  4630              MOV      r0,r6
00097a  f7fffffe          BL       _DeactivateMenu
;;;770          _DeselectItem(hObj, pObj);
00097e  4621              MOV      r1,r4
000980  4630              MOV      r0,r6
000982  f7fffffe          BL       _DeselectItem
;;;771          _ClosePopup(hObj, pObj);
000986  4621              MOV      r1,r4
000988  4630              MOV      r0,r6
00098a  f7fffffe          BL       _ClosePopup
;;;772          /* No break here. We need to forward message to owner. */
;;;773        case MENU_ON_INITMENU:
00098e  bf00              NOP      
;;;774        case MENU_ON_INITSUBMENU:
000990  bf00              NOP      
;;;775          /* Forward message to owner. */
;;;776          {
;;;777            WM_HWIN hOwner;
;;;778            hOwner = pObj->hOwner ? pObj->hOwner : WM_GetParent(hObj);
000992  f8b4005c          LDRH     r0,[r4,#0x5c]
000996  b110              CBZ      r0,|L1.2462|
000998  f9b4005c          LDRSH    r0,[r4,#0x5c]
00099c  e002              B        |L1.2468|
                  |L1.2462|
00099e  4630              MOV      r0,r6
0009a0  f7fffffe          BL       WM_GetParent
                  |L1.2468|
0009a4  4680              MOV      r8,r0
;;;779            if (hOwner) {
0009a6  f1b80f00          CMP      r8,#0
0009aa  d004              BEQ      |L1.2486|
;;;780              pMsg->hWinSrc = hObj;
0009ac  80ee              STRH     r6,[r5,#6]
;;;781              WM__SendMessage(hOwner, pMsg);
0009ae  4629              MOV      r1,r5
0009b0  4640              MOV      r0,r8
0009b2  f7fffffe          BL       WM__SendMessage
                  |L1.2486|
;;;782            }
;;;783          }
;;;784          break;
0009b6  e01f              B        |L1.2552|
;;;785        case MENU_ON_OPEN:
;;;786          pObj->Sel = -1;
0009b8  f04f30ff          MOV      r0,#0xffffffff
0009bc  f104045c          ADD      r4,r4,#0x5c
0009c0  6120              STR      r0,[r4,#0x10]
;;;787          pObj->IsSubmenuActive = 0;
0009c2  f04f0000          MOV      r0,#0
0009c6  7120              STRB     r0,[r4,#4]
;;;788          pObj->Flags |= MENU_SF_ACTIVE | MENU_SF_OPEN_ON_POINTEROVER;
0009c8  8860              LDRH     r0,[r4,#2]
0009ca  f0400042          ORR      r0,r0,#0x42
0009ce  8060              STRH     r0,[r4,#2]
0009d0  f1a4045c          SUB      r4,r4,#0x5c
;;;789          _SetCapture(hObj, pObj);
0009d4  4621              MOV      r1,r4
0009d6  4630              MOV      r0,r6
0009d8  f7fffffe          BL       _SetCapture
;;;790          MENU__ResizeMenu(hObj, pObj);
0009dc  4621              MOV      r1,r4
0009de  4630              MOV      r0,r6
0009e0  f7fffffe          BL       MENU__ResizeMenu
;;;791          break;
0009e4  e008              B        |L1.2552|
;;;792        case MENU_ON_CLOSE:
;;;793          _CloseSubmenu(hObj, pObj);
0009e6  4621              MOV      r1,r4
0009e8  4630              MOV      r0,r6
0009ea  f7fffffe          BL       _CloseSubmenu
;;;794          break;
0009ee  e003              B        |L1.2552|
;;;795        case MENU_IS_MENU:
;;;796          pMsg->Data.v = 1;
0009f0  f04f0001          MOV      r0,#1
0009f4  60a8              STR      r0,[r5,#8]
;;;797          break;
0009f6  bf00              NOP      
                  |L1.2552|
0009f8  bf00              NOP                            ;784
                  |L1.2554|
;;;798        }
;;;799      }
;;;800    }
0009fa  e8bd81f0          POP      {r4-r8,pc}
;;;801    
                          ENDP

                  _OnTouch PROC
;;;805    */
;;;806    static char _OnTouch(MENU_Handle hObj, MENU_Obj* pObj, WM_MESSAGE* pMsg) {
0009fe  b5f8              PUSH     {r3-r7,lr}
000a00  4606              MOV      r6,r0
000a02  460f              MOV      r7,r1
000a04  4615              MOV      r5,r2
;;;807      const GUI_PID_STATE* pState = (const GUI_PID_STATE*)pMsg->Data.p;
000a06  68ac              LDR      r4,[r5,#8]
;;;808      if (pState) {  /* Something happened in our area (pressed or released) */
000a08  b144              CBZ      r4,|L1.2588|
;;;809        return _HandlePID(hObj, pObj, pState->x, pState->y, pState->Pressed);
000a0a  7a20              LDRB     r0,[r4,#8]
000a0c  9000              STR      r0,[sp,#0]
000a0e  4639              MOV      r1,r7
000a10  4630              MOV      r0,r6
000a12  e9d42300          LDRD     r2,r3,[r4,#0]
000a16  f7fffffe          BL       _HandlePID
                  |L1.2586|
;;;810      }
;;;811      return _HandlePID(hObj, pObj, -1, -1, -1); /* Moved out */
;;;812    }
000a1a  bdf8              POP      {r3-r7,pc}
                  |L1.2588|
000a1c  f04f30ff          MOV      r0,#0xffffffff        ;811
000a20  4603              MOV      r3,r0                 ;811
000a22  4602              MOV      r2,r0                 ;811
000a24  4639              MOV      r1,r7                 ;811
000a26  9000              STR      r0,[sp,#0]            ;811
000a28  4630              MOV      r0,r6                 ;811
000a2a  f7fffffe          BL       _HandlePID
000a2e  e7f4              B        |L1.2586|
;;;813    
                          ENDP

                  _SetPaintColors PROC
;;;831    */
;;;832    static void _SetPaintColors(const MENU_Obj* pObj, const MENU_ITEM* pItem, int ItemIndex) {
000a30  e92d41f0          PUSH     {r4-r8,lr}
000a34  4604              MOV      r4,r0
000a36  460e              MOV      r6,r1
000a38  4617              MOV      r7,r2
;;;833      char Selected;
;;;834      unsigned ColorIndex;
;;;835      Selected = (ItemIndex == pObj->Sel) ? 1 : 0;
000a3a  6ee0              LDR      r0,[r4,#0x6c]
000a3c  42b8              CMP      r0,r7
000a3e  d102              BNE      |L1.2630|
000a40  f04f0001          MOV      r0,#1
000a44  e001              B        |L1.2634|
                  |L1.2630|
000a46  f04f0000          MOV      r0,#0
                  |L1.2634|
000a4a  4680              MOV      r8,r0
;;;836      if (pObj->IsSubmenuActive && Selected) {
000a4c  f8940060          LDRB     r0,[r4,#0x60]
000a50  b128              CBZ      r0,|L1.2654|
000a52  f1b80f00          CMP      r8,#0
000a56  d002              BEQ      |L1.2654|
;;;837        ColorIndex = MENU_CI_ACTIVE_SUBMENU;
000a58  f04f0504          MOV      r5,#4
000a5c  e01d              B        |L1.2714|
                  |L1.2654|
;;;838      } else if (pItem->Flags & MENU_IF_SEPARATOR) {
000a5e  88b0              LDRH     r0,[r6,#4]
000a60  f0100f02          TST      r0,#2
000a64  d002              BEQ      |L1.2668|
;;;839        ColorIndex = MENU_CI_ENABLED;
000a66  f04f0500          MOV      r5,#0
000a6a  e016              B        |L1.2714|
                  |L1.2668|
;;;840      } else {
;;;841        ColorIndex = (Selected) ? MENU_CI_SELECTED : MENU_CI_ENABLED;
000a6c  f1b80f00          CMP      r8,#0
000a70  d002              BEQ      |L1.2680|
000a72  f04f0001          MOV      r0,#1
000a76  e001              B        |L1.2684|
                  |L1.2680|
000a78  f04f0000          MOV      r0,#0
                  |L1.2684|
000a7c  4605              MOV      r5,r0
;;;842        if (pItem->Flags & MENU_IF_DISABLED) {
000a7e  88b0              LDRH     r0,[r6,#4]
000a80  f0100f01          TST      r0,#1
000a84  d009              BEQ      |L1.2714|
;;;843          if (pObj->Flags & MENU_CF_HIDE_DISABLED_SEL) {
000a86  f8b4005e          LDRH     r0,[r4,#0x5e]
000a8a  f0100f08          TST      r0,#8
000a8e  d002              BEQ      |L1.2710|
;;;844            ColorIndex = MENU_CI_DISABLED;
000a90  f04f0502          MOV      r5,#2
000a94  e001              B        |L1.2714|
                  |L1.2710|
;;;845          } else {
;;;846            ColorIndex += MENU_CI_DISABLED;
000a96  f1050502          ADD      r5,r5,#2
                  |L1.2714|
;;;847          }
;;;848        }
;;;849      }
;;;850      GUI_SetBkColor(pObj->Props.aBkColor[ColorIndex]);
000a9a  f104013c          ADD      r1,r4,#0x3c
000a9e  f8510025          LDR      r0,[r1,r5,LSL #2]
000aa2  f7fffffe          BL       GUI_SetBkColor
;;;851      GUI_SetColor(pObj->Props.aTextColor[ColorIndex]);
000aa6  f1040128          ADD      r1,r4,#0x28
000aaa  f8510025          LDR      r0,[r1,r5,LSL #2]
000aae  f7fffffe          BL       GUI_SetColor
;;;852    }
000ab2  e8bd81f0          POP      {r4-r8,pc}
;;;853    
                          ENDP

                  _OnPaint PROC
;;;857    */
;;;858    static void _OnPaint(MENU_Handle hObj, MENU_Obj* pObj) {
000ab6  e92d4ff3          PUSH     {r0,r1,r4-r11,lr}
000aba  b089              SUB      sp,sp,#0x24
000abc  460c              MOV      r4,r1
;;;859      GUI_RECT FillRect, TextRect;
;;;860      MENU_ITEM* pItem;
;;;861      unsigned TextWidth, NumItems, i;
;;;862      U8 BorderLeft   = pObj->Props.aBorder[MENU_BI_LEFT];
000abe  f8949050          LDRB     r9,[r4,#0x50]
;;;863      U8 BorderTop    = pObj->Props.aBorder[MENU_BI_TOP];
000ac2  f894a052          LDRB     r10,[r4,#0x52]
;;;864      int FontHeight  = GUI_GetYDistOfFont(pObj->Props.pFont);
000ac6  6d60              LDR      r0,[r4,#0x54]
000ac8  f7fffffe          BL       GUI_GetYDistOfFont
000acc  9003              STR      r0,[sp,#0xc]
;;;865      int EffectSize  = _GetEffectSize(hObj, pObj);
000ace  4621              MOV      r1,r4
000ad0  9809              LDR      r0,[sp,#0x24]
000ad2  f7fffffe          BL       _GetEffectSize
000ad6  4607              MOV      r7,r0
;;;866      NumItems = MENU__GetNumItems(pObj);
000ad8  4620              MOV      r0,r4
000ada  f7fffffe          BL       MENU__GetNumItems
000ade  9004              STR      r0,[sp,#0x10]
;;;867      WM__GetClientRectWin(&pObj->Widget.Win, &FillRect);
000ae0  a907              ADD      r1,sp,#0x1c
000ae2  4620              MOV      r0,r4
000ae4  f7fffffe          BL       WM__GetClientRectWin
;;;868      GUI__ReduceRect(&FillRect, &FillRect, EffectSize);
000ae8  463a              MOV      r2,r7
000aea  a907              ADD      r1,sp,#0x1c
000aec  a807              ADD      r0,sp,#0x1c
000aee  f7fffffe          BL       GUI__ReduceRect
;;;869      GUI_SetFont(pObj->Props.pFont);
000af2  6d60              LDR      r0,[r4,#0x54]
000af4  f7fffffe          BL       GUI_SetFont
;;;870      if (pObj->Flags & MENU_SF_VERTICAL) {
000af8  f8b4005e          LDRH     r0,[r4,#0x5e]
000afc  f0100f01          TST      r0,#1
000b00  d072              BEQ      |L1.3048|
;;;871        int ItemHeight, xSize;
;;;872        xSize = _CalcMenuSizeX(hObj, pObj);
000b02  4621              MOV      r1,r4
000b04  9809              LDR      r0,[sp,#0x24]
000b06  f7fffffe          BL       _CalcMenuSizeX
000b0a  9002              STR      r0,[sp,#8]
;;;873        FillRect.x1 = xSize - EffectSize - 1;
000b0c  9802              LDR      r0,[sp,#8]
000b0e  eba00007          SUB      r0,r0,r7
000b12  f1a00001          SUB      r0,r0,#1
000b16  b200              SXTH     r0,r0
000b18  f8ad0020          STRH     r0,[sp,#0x20]
;;;874        TextRect.x0 = FillRect.x0 + BorderLeft;
000b1c  f8bd001c          LDRH     r0,[sp,#0x1c]
000b20  4448              ADD      r0,r0,r9
000b22  b200              SXTH     r0,r0
000b24  f8ad0014          STRH     r0,[sp,#0x14]
;;;875        for (i = 0; i < NumItems; i++) {
000b28  f04f0600          MOV      r6,#0
000b2c  e057              B        |L1.3038|
                  |L1.2862|
;;;876          pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, i);
000b2e  4631              MOV      r1,r6
000b30  f1040058          ADD      r0,r4,#0x58
000b34  f7fffffe          BL       GUI_ARRAY_GetpItem
000b38  4605              MOV      r5,r0
;;;877          ItemHeight = _GetItemHeight(hObj, pObj, i);
000b3a  4632              MOV      r2,r6
000b3c  4621              MOV      r1,r4
000b3e  9809              LDR      r0,[sp,#0x24]
000b40  f7fffffe          BL       _GetItemHeight
000b44  4683              MOV      r11,r0
;;;878          _SetPaintColors(pObj, pItem, i);
000b46  4632              MOV      r2,r6
000b48  4629              MOV      r1,r5
000b4a  4620              MOV      r0,r4
000b4c  f7fffffe          BL       _SetPaintColors
;;;879          FillRect.y1 = FillRect.y0 + ItemHeight - 1;
000b50  f8bd001e          LDRH     r0,[sp,#0x1e]
000b54  4458              ADD      r0,r0,r11
000b56  f1a00001          SUB      r0,r0,#1
000b5a  b200              SXTH     r0,r0
000b5c  f8ad0022          STRH     r0,[sp,#0x22]
;;;880          if (pItem->Flags & MENU_IF_SEPARATOR) {
000b60  88a8              LDRH     r0,[r5,#4]
000b62  f0100f02          TST      r0,#2
000b66  d012              BEQ      |L1.2958|
;;;881            GUI_ClearRectEx(&FillRect);
000b68  a807              ADD      r0,sp,#0x1c
000b6a  f7fffffe          BL       GUI_ClearRectEx
;;;882            GUI_SetColor(0x7C7C7C);
000b6e  48fa              LDR      r0,|L1.3928|
000b70  f7fffffe          BL       GUI_SetColor
;;;883            GUI_DrawHLine(FillRect.y0 + BorderTop + 1, FillRect.x0 + 2, FillRect.x1 - 2);
000b74  f9bd3020          LDRSH    r3,[sp,#0x20]
000b78  1e9a              SUBS     r2,r3,#2
000b7a  f9bd301c          LDRSH    r3,[sp,#0x1c]
000b7e  1c99              ADDS     r1,r3,#2
000b80  f9bd301e          LDRSH    r3,[sp,#0x1e]
000b84  4453              ADD      r3,r3,r10
000b86  1c58              ADDS     r0,r3,#1
000b88  f7fffffe          BL       GUI_DrawHLine
000b8c  e01f              B        |L1.3022|
                  |L1.2958|
;;;884          } else {
;;;885            TextWidth = pItem->TextWidth;
000b8e  f8d58008          LDR      r8,[r5,#8]
;;;886            TextRect.x1 = TextRect.x0 + TextWidth - 1;
000b92  f8bd0014          LDRH     r0,[sp,#0x14]
000b96  4440              ADD      r0,r0,r8
000b98  f1a00001          SUB      r0,r0,#1
000b9c  b200              SXTH     r0,r0
000b9e  f8ad0018          STRH     r0,[sp,#0x18]
;;;887            TextRect.y0 = FillRect.y0 + BorderTop;
000ba2  f8bd001e          LDRH     r0,[sp,#0x1e]
000ba6  4450              ADD      r0,r0,r10
000ba8  b200              SXTH     r0,r0
000baa  f8ad0016          STRH     r0,[sp,#0x16]
;;;888            TextRect.y1 = TextRect.y0 + FontHeight - 1;
000bae  f8bd1016          LDRH     r1,[sp,#0x16]
000bb2  9803              LDR      r0,[sp,#0xc]
000bb4  4408              ADD      r0,r0,r1
000bb6  f1a00001          SUB      r0,r0,#1
000bba  b200              SXTH     r0,r0
000bbc  f8ad001a          STRH     r0,[sp,#0x1a]
;;;889            WIDGET__FillStringInRect(pItem->acText, &FillRect, &TextRect, &TextRect);
000bc0  ab05              ADD      r3,sp,#0x14
000bc2  aa05              ADD      r2,sp,#0x14
000bc4  a907              ADD      r1,sp,#0x1c
000bc6  f105000c          ADD      r0,r5,#0xc
000bca  f7fffffe          BL       WIDGET__FillStringInRect
                  |L1.3022|
;;;890          }
;;;891          FillRect.y0 += ItemHeight;
000bce  f8bd001e          LDRH     r0,[sp,#0x1e]
000bd2  4458              ADD      r0,r0,r11
000bd4  b200              SXTH     r0,r0
000bd6  f8ad001e          STRH     r0,[sp,#0x1e]
000bda  f1060601          ADD      r6,r6,#1              ;875
                  |L1.3038|
000bde  9804              LDR      r0,[sp,#0x10]         ;875
000be0  4286              CMP      r6,r0                 ;875
000be2  d3a4              BCC      |L1.2862|
;;;892        }
;;;893      } else {
000be4  e072              B        |L1.3276|
000be6  e7ff              B        |L1.3048|
                  |L1.3048|
;;;894        int ItemWidth, ySize;
;;;895        ySize = _CalcMenuSizeY(hObj, pObj);
000be8  4621              MOV      r1,r4
000bea  9809              LDR      r0,[sp,#0x24]
000bec  f7fffffe          BL       _CalcMenuSizeY
000bf0  9002              STR      r0,[sp,#8]
;;;896        FillRect.y1 = ySize - EffectSize - 1;
000bf2  9802              LDR      r0,[sp,#8]
000bf4  eba00007          SUB      r0,r0,r7
000bf8  f1a00001          SUB      r0,r0,#1
000bfc  b200              SXTH     r0,r0
000bfe  f8ad0022          STRH     r0,[sp,#0x22]
;;;897        TextRect.y0 = FillRect.y0 + BorderTop;
000c02  f8bd001e          LDRH     r0,[sp,#0x1e]
000c06  4450              ADD      r0,r0,r10
000c08  b200              SXTH     r0,r0
000c0a  f8ad0016          STRH     r0,[sp,#0x16]
;;;898        TextRect.y1 = TextRect.y0 + FontHeight - 1;
000c0e  f8bd1016          LDRH     r1,[sp,#0x16]
000c12  9803              LDR      r0,[sp,#0xc]
000c14  4408              ADD      r0,r0,r1
000c16  f1a00001          SUB      r0,r0,#1
000c1a  b200              SXTH     r0,r0
000c1c  f8ad001a          STRH     r0,[sp,#0x1a]
;;;899        for (i = 0; i < NumItems; i++) {
000c20  f04f0600          MOV      r6,#0
000c24  e04e              B        |L1.3268|
                  |L1.3110|
;;;900          pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, i);
000c26  4631              MOV      r1,r6
000c28  f1040058          ADD      r0,r4,#0x58
000c2c  f7fffffe          BL       GUI_ARRAY_GetpItem
000c30  4605              MOV      r5,r0
;;;901          ItemWidth = _GetItemWidth(hObj, pObj, i);
000c32  4632              MOV      r2,r6
000c34  4621              MOV      r1,r4
000c36  9809              LDR      r0,[sp,#0x24]
000c38  f7fffffe          BL       _GetItemWidth
000c3c  4683              MOV      r11,r0
;;;902          _SetPaintColors(pObj, pItem, i);
000c3e  4632              MOV      r2,r6
000c40  4629              MOV      r1,r5
000c42  4620              MOV      r0,r4
000c44  f7fffffe          BL       _SetPaintColors
;;;903          FillRect.x1 = FillRect.x0 + ItemWidth - 1;
000c48  f8bd001c          LDRH     r0,[sp,#0x1c]
000c4c  4458              ADD      r0,r0,r11
000c4e  f1a00001          SUB      r0,r0,#1
000c52  b200              SXTH     r0,r0
000c54  f8ad0020          STRH     r0,[sp,#0x20]
;;;904          if (pItem->Flags & MENU_IF_SEPARATOR) {
000c58  88a8              LDRH     r0,[r5,#4]
000c5a  f0100f02          TST      r0,#2
000c5e  d012              BEQ      |L1.3206|
;;;905            GUI_ClearRectEx(&FillRect);
000c60  a807              ADD      r0,sp,#0x1c
000c62  f7fffffe          BL       GUI_ClearRectEx
;;;906            GUI_SetColor(0x7C7C7C);
000c66  48bc              LDR      r0,|L1.3928|
000c68  f7fffffe          BL       GUI_SetColor
;;;907            GUI_DrawVLine(FillRect.x0 + BorderLeft + 1, FillRect.y0 + 2, FillRect.y1 - 2);
000c6c  f9bd3022          LDRSH    r3,[sp,#0x22]
000c70  1e9a              SUBS     r2,r3,#2
000c72  f9bd301e          LDRSH    r3,[sp,#0x1e]
000c76  1c99              ADDS     r1,r3,#2
000c78  f9bd301c          LDRSH    r3,[sp,#0x1c]
000c7c  444b              ADD      r3,r3,r9
000c7e  1c58              ADDS     r0,r3,#1
000c80  f7fffffe          BL       GUI_DrawVLine
000c84  e016              B        |L1.3252|
                  |L1.3206|
;;;908          } else {
;;;909            TextWidth = pItem->TextWidth;
000c86  f8d58008          LDR      r8,[r5,#8]
;;;910            TextRect.x0 = FillRect.x0 + BorderLeft;
000c8a  f8bd001c          LDRH     r0,[sp,#0x1c]
000c8e  4448              ADD      r0,r0,r9
000c90  b200              SXTH     r0,r0
000c92  f8ad0014          STRH     r0,[sp,#0x14]
;;;911            TextRect.x1 = TextRect.x0 + TextWidth - 1;
000c96  f8bd0014          LDRH     r0,[sp,#0x14]
000c9a  4440              ADD      r0,r0,r8
000c9c  f1a00001          SUB      r0,r0,#1
000ca0  b200              SXTH     r0,r0
000ca2  f8ad0018          STRH     r0,[sp,#0x18]
;;;912            WIDGET__FillStringInRect(pItem->acText, &FillRect, &TextRect, &TextRect);
000ca6  ab05              ADD      r3,sp,#0x14
000ca8  aa05              ADD      r2,sp,#0x14
000caa  a907              ADD      r1,sp,#0x1c
000cac  f105000c          ADD      r0,r5,#0xc
000cb0  f7fffffe          BL       WIDGET__FillStringInRect
                  |L1.3252|
;;;913          }
;;;914          FillRect.x0 += ItemWidth;
000cb4  f8bd001c          LDRH     r0,[sp,#0x1c]
000cb8  4458              ADD      r0,r0,r11
000cba  b200              SXTH     r0,r0
000cbc  f8ad001c          STRH     r0,[sp,#0x1c]
000cc0  f1060601          ADD      r6,r6,#1              ;899
                  |L1.3268|
000cc4  9804              LDR      r0,[sp,#0x10]         ;899
000cc6  4286              CMP      r6,r0                 ;899
000cc8  d3ad              BCC      |L1.3110|
;;;915        }
;;;916      }
000cca  bf00              NOP      
                  |L1.3276|
;;;917      if (pObj->Width || pObj->Height) {
000ccc  6e60              LDR      r0,[r4,#0x64]
000cce  b908              CBNZ     r0,|L1.3284|
000cd0  6ea0              LDR      r0,[r4,#0x68]
000cd2  b300              CBZ      r0,|L1.3350|
                  |L1.3284|
;;;918        GUI_RECT r;
;;;919        WM__GetClientRectWin(&pObj->Widget.Win, &r);
000cd4  a901              ADD      r1,sp,#4
000cd6  4620              MOV      r0,r4
000cd8  f7fffffe          BL       WM__GetClientRectWin
;;;920        GUI__ReduceRect(&r, &r, EffectSize);
000cdc  463a              MOV      r2,r7
000cde  a901              ADD      r1,sp,#4
000ce0  a801              ADD      r0,sp,#4
000ce2  f7fffffe          BL       GUI__ReduceRect
;;;921        GUI_SetBkColor(pObj->Props.aBkColor[MENU_CI_ENABLED]);
000ce6  6be0              LDR      r0,[r4,#0x3c]
000ce8  f7fffffe          BL       GUI_SetBkColor
;;;922        GUI_ClearRect(FillRect.x1 + 1, EffectSize, r.x1, FillRect.y1);
000cec  f9bd3022          LDRSH    r3,[sp,#0x22]
000cf0  f9bd2008          LDRSH    r2,[sp,#8]
000cf4  f9bd1020          LDRSH    r1,[sp,#0x20]
000cf8  1c48              ADDS     r0,r1,#1
000cfa  4639              MOV      r1,r7
000cfc  f7fffffe          BL       GUI_ClearRect
;;;923        GUI_ClearRect(EffectSize, FillRect.y1 + 1, r.x1, r.y1);
000d00  f9bd300a          LDRSH    r3,[sp,#0xa]
000d04  f9bd2008          LDRSH    r2,[sp,#8]
000d08  f9bd0022          LDRSH    r0,[sp,#0x22]
000d0c  1c41              ADDS     r1,r0,#1
000d0e  4638              MOV      r0,r7
000d10  f7fffffe          BL       GUI_ClearRect
;;;924      }
000d14  bf00              NOP      
                  |L1.3350|
;;;925      /* Draw 3D effect (if configured) */
;;;926      if (_HasEffect(hObj, pObj)) {
000d16  4621              MOV      r1,r4
000d18  9809              LDR      r0,[sp,#0x24]
000d1a  f7fffffe          BL       _HasEffect
000d1e  b110              CBZ      r0,|L1.3366|
;;;927        pObj->Widget.pEffect->pfDrawUp();
000d20  6a21              LDR      r1,[r4,#0x20]
000d22  6808              LDR      r0,[r1,#0]
000d24  4780              BLX      r0
                  |L1.3366|
;;;928      }
;;;929    }
000d26  b00b              ADD      sp,sp,#0x2c
000d28  e8bd8ff0          POP      {r4-r11,pc}
;;;930    
                          ENDP

                  _MENU_Callback PROC
;;;934    */
;;;935    static void _MENU_Callback(WM_MESSAGE* pMsg) {
000d2c  b570              PUSH     {r4-r6,lr}
000d2e  4604              MOV      r4,r0
;;;936      MENU_Handle hObj;
;;;937      MENU_Obj* pObj;
;;;938      hObj = pMsg->hWin;
000d30  f9b46004          LDRSH    r6,[r4,#4]
;;;939      if (pMsg->MsgId != WM_PID_STATE_CHANGED) {
000d34  6820              LDR      r0,[r4,#0]
000d36  2811              CMP      r0,#0x11
000d38  d005              BEQ      |L1.3398|
;;;940        /* Let widget handle the standard messages */
;;;941        if (WIDGET_HandleActive(hObj, pMsg) == 0) {
000d3a  4621              MOV      r1,r4
000d3c  4630              MOV      r0,r6
000d3e  f7fffffe          BL       WIDGET_HandleActive
000d42  b900              CBNZ     r0,|L1.3398|
                  |L1.3396|
;;;942          return;
;;;943        }
;;;944      }
;;;945      pObj = (MENU_Obj*) GUI_ALLOC_h2p(hObj);
;;;946      switch (pMsg->MsgId) {
;;;947      case WM_MENU:
;;;948        _OnMenu(hObj, pObj, pMsg);
;;;949        return;     /* Message handled, do not call WM_DefaultProc() here. */
;;;950      case WM_TOUCH:
;;;951        if (_OnTouch(hObj, pObj, pMsg)) {
;;;952          _ForwardPIDMsgToOwner(hObj, pObj, pMsg);
;;;953        }
;;;954        break;
;;;955    #if (GUI_SUPPORT_MOUSE)
;;;956      case WM_MOUSEOVER:
;;;957        if (_OnMouseOver(hObj, pObj, pMsg)) {
;;;958          _ForwardPIDMsgToOwner(hObj, pObj, pMsg);
;;;959        }
;;;960        break;
;;;961    #endif
;;;962      case WM_PAINT:
;;;963        _OnPaint(hObj, pObj);
;;;964        break;
;;;965      case WM_DELETE:
;;;966        GUI_ARRAY_Delete(&pObj->ItemArray);
;;;967        break;      /* No return here ... WM_DefaultProc needs to be called */
;;;968      }
;;;969      WM_DefaultProc(pMsg);
;;;970    }
000d44  bd70              POP      {r4-r6,pc}
                  |L1.3398|
000d46  4630              MOV      r0,r6                 ;945
000d48  f7fffffe          BL       GUI_ALLOC_h2p
000d4c  4605              MOV      r5,r0                 ;945
000d4e  6820              LDR      r0,[r4,#0]            ;946
000d50  280b              CMP      r0,#0xb               ;946
000d52  d01c              BEQ      |L1.3470|
000d54  280c              CMP      r0,#0xc               ;946
000d56  d009              BEQ      |L1.3436|
000d58  280f              CMP      r0,#0xf               ;946
000d5a  d013              BEQ      |L1.3460|
000d5c  282c              CMP      r0,#0x2c              ;946
000d5e  d11b              BNE      |L1.3480|
000d60  4622              MOV      r2,r4                 ;948
000d62  4629              MOV      r1,r5                 ;948
000d64  4630              MOV      r0,r6                 ;948
000d66  f7fffffe          BL       _OnMenu
000d6a  e7eb              B        |L1.3396|
                  |L1.3436|
000d6c  4622              MOV      r2,r4                 ;951
000d6e  4629              MOV      r1,r5                 ;951
000d70  4630              MOV      r0,r6                 ;951
000d72  f7fffffe          BL       _OnTouch
000d76  b120              CBZ      r0,|L1.3458|
000d78  4622              MOV      r2,r4                 ;952
000d7a  4629              MOV      r1,r5                 ;952
000d7c  4630              MOV      r0,r6                 ;952
000d7e  f7fffffe          BL       _ForwardPIDMsgToOwner
                  |L1.3458|
000d82  e009              B        |L1.3480|
                  |L1.3460|
000d84  4629              MOV      r1,r5                 ;963
000d86  4630              MOV      r0,r6                 ;963
000d88  f7fffffe          BL       _OnPaint
000d8c  e004              B        |L1.3480|
                  |L1.3470|
000d8e  f1050058          ADD      r0,r5,#0x58           ;966
000d92  f7fffffe          BL       GUI_ARRAY_Delete
000d96  bf00              NOP                            ;967
                  |L1.3480|
000d98  bf00              NOP                            ;954
000d9a  4620              MOV      r0,r4                 ;969
000d9c  f7fffffe          BL       WM_DefaultProc
000da0  bf00              NOP      
000da2  e7cf              B        |L1.3396|
;;;971    
                          ENDP

                  MENU_CreateEx PROC
;;;981    */
;;;982    MENU_Handle MENU_CreateEx(int x0, int y0, int xSize, int ySize, WM_HWIN hParent, int WinFlags, int ExFlags, int Id) {
000da4  e92d5fff          PUSH     {r0-r12,lr}
000da8  4681              MOV      r9,r0
000daa  468a              MOV      r10,r1
000dac  4616              MOV      r6,r2
000dae  461f              MOV      r7,r3
000db0  f8ddb038          LDR      r11,[sp,#0x38]
000db4  9d10              LDR      r5,[sp,#0x40]
;;;983      MENU_Handle hObj;
;;;984      /* Create the window */
;;;985      hObj = WM_CreateWindowAsChild(x0, y0, xSize, ySize, hParent, WM_CF_SHOW | WM_CF_STAYONTOP | WinFlags, &_MENU_Callback,
000db6  f04f0150          MOV      r1,#0x50
000dba  4a68              LDR      r2,|L1.3932|
000dbc  980f              LDR      r0,[sp,#0x3c]
000dbe  b280              UXTH     r0,r0
000dc0  f040000a          ORR      r0,r0,#0xa
000dc4  463b              MOV      r3,r7
000dc6  e9cdb000          STRD     r11,r0,[sp,#0]
000dca  e9cd2102          STRD     r2,r1,[sp,#8]
000dce  4632              MOV      r2,r6
000dd0  4651              MOV      r1,r10
000dd2  4648              MOV      r0,r9
000dd4  f7fffffe          BL       WM_CreateWindowAsChild
000dd8  4680              MOV      r8,r0
;;;986                                    sizeof(MENU_Obj) - sizeof(WM_Obj));
;;;987      if (hObj) {
000dda  f1b80f00          CMP      r8,#0
000dde  d036              BEQ      |L1.3662|
;;;988        MENU_Obj* pObj;
;;;989        WM_LOCK();
;;;990        pObj = (MENU_Obj*)GUI_ALLOC_h2p(hObj);
000de0  4640              MOV      r0,r8
000de2  f7fffffe          BL       GUI_ALLOC_h2p
000de6  4604              MOV      r4,r0
;;;991         /* Init sub-classes */
;;;992        GUI_ARRAY_CREATE(&pObj->ItemArray);
;;;993        /* init widget specific variables */
;;;994        WIDGET__Init(&pObj->Widget, Id, WIDGET_STATE_FOCUSSABLE);
000de8  f04f0210          MOV      r2,#0x10
000dec  4620              MOV      r0,r4
000dee  9911              LDR      r1,[sp,#0x44]
000df0  f7fffffe          BL       WIDGET__Init
;;;995        /* init member variables */
;;;996        if (ExFlags & MENU_SF_OPEN_ON_POINTEROVER) {
000df4  f0150f02          TST      r5,#2
000df8  d002              BEQ      |L1.3584|
;;;997          ExFlags |= MENU_SF_ACTIVE;
000dfa  f0450540          ORR      r5,r5,#0x40
000dfe  e001              B        |L1.3588|
                  |L1.3584|
;;;998        } else {
;;;999          ExFlags &= ~(MENU_SF_ACTIVE);
000e00  f0250540          BIC      r5,r5,#0x40
                  |L1.3588|
;;;1000       }
;;;1001       pObj->Props           = MENU__DefaultProps;
000e04  2230              MOVS     r2,#0x30
000e06  4956              LDR      r1,|L1.3936|
000e08  f1040028          ADD      r0,r4,#0x28
000e0c  f7fffffe          BL       __aeabi_memcpy4
;;;1002       pObj->Flags           = ExFlags;
000e10  f8a4505e          STRH     r5,[r4,#0x5e]
;;;1003       pObj->Width           = ((xSize > 0) ? xSize : 0);
000e14  2e00              CMP      r6,#0
000e16  dd01              BLE      |L1.3612|
000e18  4630              MOV      r0,r6
000e1a  e001              B        |L1.3616|
                  |L1.3612|
000e1c  f04f0000          MOV      r0,#0
                  |L1.3616|
000e20  6660              STR      r0,[r4,#0x64]
;;;1004       pObj->Height          = ((ySize > 0) ? ySize : 0);
000e22  2f00              CMP      r7,#0
000e24  dd01              BLE      |L1.3626|
000e26  4638              MOV      r0,r7
000e28  e001              B        |L1.3630|
                  |L1.3626|
000e2a  f04f0000          MOV      r0,#0
                  |L1.3630|
000e2e  66a0              STR      r0,[r4,#0x68]
;;;1005       pObj->Sel             = -1;
000e30  f04f30ff          MOV      r0,#0xffffffff
000e34  66e0              STR      r0,[r4,#0x6c]
;;;1006       pObj->hOwner          = 0;
000e36  f04f0000          MOV      r0,#0
000e3a  f8a4005c          STRH     r0,[r4,#0x5c]
;;;1007       pObj->IsSubmenuActive = 0;
000e3e  f8840060          STRB     r0,[r4,#0x60]
;;;1008       WIDGET_SetEffect(hObj, MENU__pDefaultEffect);
000e42  4848              LDR      r0,|L1.3940|
000e44  6801              LDR      r1,[r0,#0]  ; MENU__pDefaultEffect
000e46  4640              MOV      r0,r8
000e48  f7fffffe          BL       WIDGET_SetEffect
;;;1009       INIT_ID(pObj);
;;;1010       WM_UNLOCK();
;;;1011     } else {
000e4c  bf00              NOP      
                  |L1.3662|
;;;1012       GUI_DEBUG_ERROROUT_IF(hObj==0, "MENU_CreateEx failed")
;;;1013     }
;;;1014     return hObj;
000e4e  4640              MOV      r0,r8
;;;1015   }
000e50  b004              ADD      sp,sp,#0x10
000e52  e8bd9ff0          POP      {r4-r12,pc}
;;;1016   
                          ENDP

                  MENU__RecalcTextWidthOfItems PROC
;;;1044   */
;;;1045   void MENU__RecalcTextWidthOfItems(MENU_Obj* pObj) {
000e56  e92d41f0          PUSH     {r4-r8,lr}
000e5a  4604              MOV      r4,r0
;;;1046     const GUI_FONT GUI_UNI_PTR* pOldFont;
;;;1047     MENU_ITEM* pItem;
;;;1048     unsigned i, NumItems;
;;;1049     NumItems = MENU__GetNumItems(pObj);
000e5c  4620              MOV      r0,r4
000e5e  f7fffffe          BL       MENU__GetNumItems
000e62  4680              MOV      r8,r0
;;;1050     pOldFont  = GUI_SetFont(pObj->Props.pFont);
000e64  6d60              LDR      r0,[r4,#0x54]
000e66  f7fffffe          BL       GUI_SetFont
000e6a  4607              MOV      r7,r0
;;;1051     for (i = 0; i < NumItems; i++) {
000e6c  f04f0600          MOV      r6,#0
000e70  e00c              B        |L1.3724|
                  |L1.3698|
;;;1052       pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, i);
000e72  4631              MOV      r1,r6
000e74  f1040058          ADD      r0,r4,#0x58
000e78  f7fffffe          BL       GUI_ARRAY_GetpItem
000e7c  4605              MOV      r5,r0
;;;1053       pItem->TextWidth = GUI_GetStringDistX(pItem->acText);
000e7e  f105000c          ADD      r0,r5,#0xc
000e82  f7fffffe          BL       GUI_GetStringDistX
000e86  60a8              STR      r0,[r5,#8]
000e88  f1060601          ADD      r6,r6,#1              ;1051
                  |L1.3724|
000e8c  4546              CMP      r6,r8                 ;1051
000e8e  d3f0              BCC      |L1.3698|
;;;1054     }
;;;1055     GUI_SetFont(pOldFont);
000e90  4638              MOV      r0,r7
000e92  f7fffffe          BL       GUI_SetFont
;;;1056   }
000e96  e8bd81f0          POP      {r4-r8,pc}
;;;1057   
                          ENDP

                  MENU__SetItem PROC
;;;1073   */
;;;1074   char MENU__SetItem(MENU_Handle hObj, MENU_Obj* pObj, unsigned Index, const MENU_ITEM_DATA* pItemData) {
000e9a  e92d47ff          PUSH     {r0-r10,lr}
000e9e  4607              MOV      r7,r0
000ea0  460d              MOV      r5,r1
000ea2  4690              MOV      r8,r2
000ea4  461c              MOV      r4,r3
;;;1075     MENU_ITEM Item = {0};
000ea6  f04f0000          MOV      r0,#0
000eaa  9000              STR      r0,[sp,#0]
000eac  9001              STR      r0,[sp,#4]
000eae  9002              STR      r0,[sp,#8]
000eb0  9003              STR      r0,[sp,#0xc]
;;;1076     const char* pText;
;;;1077     pText = pItemData->pText;
000eb2  6826              LDR      r6,[r4,#0]
;;;1078     if (!pText) {
000eb4  b906              CBNZ     r6,|L1.3768|
;;;1079       pText = "";
000eb6  a62c              ADR      r6,|L1.3944|
                  |L1.3768|
;;;1080     }
;;;1081     Item.Id        = pItemData->Id;
000eb8  88a0              LDRH     r0,[r4,#4]
000eba  f8ad0002          STRH     r0,[sp,#2]
;;;1082     Item.Flags     = pItemData->Flags;
000ebe  88e0              LDRH     r0,[r4,#6]
000ec0  f8ad0004          STRH     r0,[sp,#4]
;;;1083     Item.hSubmenu  = pItemData->hSubmenu;
000ec4  8920              LDRH     r0,[r4,#8]
000ec6  f8ad0000          STRH     r0,[sp,#0]
;;;1084     Item.TextWidth = _CalcTextWidth(pObj, pText);
000eca  4631              MOV      r1,r6
000ecc  4628              MOV      r0,r5
000ece  f7fffffe          BL       _CalcTextWidth
000ed2  9002              STR      r0,[sp,#8]
;;;1085     if (Item.Flags & MENU_IF_SEPARATOR) {
000ed4  f8bd0004          LDRH     r0,[sp,#4]
000ed8  f0100f02          TST      r0,#2
000edc  d003              BEQ      |L1.3814|
;;;1086       Item.hSubmenu = 0;   /* Ensures that no separator is a submenu */
000ede  f04f0000          MOV      r0,#0
000ee2  f8ad0000          STRH     r0,[sp,#0]
                  |L1.3814|
;;;1087     }
;;;1088     if (GUI_ARRAY_SetItem(&pObj->ItemArray, Index, &Item, sizeof(MENU_ITEM) + strlen(pText)) != 0) {
000ee6  4630              MOV      r0,r6
000ee8  f7fffffe          BL       strlen
000eec  f1000910          ADD      r9,r0,#0x10
000ef0  464b              MOV      r3,r9
000ef2  466a              MOV      r2,sp
000ef4  4641              MOV      r1,r8
000ef6  f1050058          ADD      r0,r5,#0x58
000efa  f7fffffe          BL       GUI_ARRAY_SetItem
000efe  b198              CBZ      r0,|L1.3880|
;;;1089       MENU_ITEM* pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
000f00  4641              MOV      r1,r8
000f02  f1050058          ADD      r0,r5,#0x58
000f06  f7fffffe          BL       GUI_ARRAY_GetpItem
000f0a  4681              MOV      r9,r0
;;;1090       strcpy(pItem->acText, pText);
000f0c  4631              MOV      r1,r6
000f0e  f109000c          ADD      r0,r9,#0xc
000f12  f7fffffe          BL       strcpy
;;;1091       MENU_SetOwner(Item.hSubmenu, hObj);
000f16  f9bd0000          LDRSH    r0,[sp,#0]
000f1a  4639              MOV      r1,r7
000f1c  f7fffffe          BL       MENU_SetOwner
;;;1092       return 1;
000f20  2001              MOVS     r0,#1
                  |L1.3874|
;;;1093     }
;;;1094     return 0;
;;;1095   }
000f22  b004              ADD      sp,sp,#0x10
000f24  e8bd87f0          POP      {r4-r10,pc}
                  |L1.3880|
000f28  2000              MOVS     r0,#0                 ;1094
000f2a  e7fa              B        |L1.3874|
;;;1096   
                          ENDP

                  MENU__SetItemFlags PROC
;;;1100   */
;;;1101   void MENU__SetItemFlags(MENU_Obj* pObj, unsigned Index, U16 Mask, U16 Flags) {
000f2c  e92d41f0          PUSH     {r4-r8,lr}
000f30  4605              MOV      r5,r0
000f32  4688              MOV      r8,r1
000f34  4616              MOV      r6,r2
000f36  461f              MOV      r7,r3
;;;1102     MENU_ITEM* pItem = (MENU_ITEM*)GUI_ARRAY_GetpItem(&pObj->ItemArray, Index);
000f38  4641              MOV      r1,r8
000f3a  f1050058          ADD      r0,r5,#0x58
000f3e  f7fffffe          BL       GUI_ARRAY_GetpItem
000f42  4604              MOV      r4,r0
;;;1103     pItem->Flags &= ~Mask;
000f44  88a0              LDRH     r0,[r4,#4]
000f46  ea200006          BIC      r0,r0,r6
000f4a  80a0              STRH     r0,[r4,#4]
;;;1104     pItem->Flags |= Flags;
000f4c  88a0              LDRH     r0,[r4,#4]
000f4e  ea400007          ORR      r0,r0,r7
000f52  80a0              STRH     r0,[r4,#4]
;;;1105   }
000f54  e8bd81f0          POP      {r4-r8,pc}
                  |L1.3928|
                          DCD      0x007c7c7c
                  |L1.3932|
                          DCD      _MENU_Callback
                  |L1.3936|
                          DCD      MENU__DefaultProps
                  |L1.3940|
                          DCD      MENU__pDefaultEffect
                  |L1.3944|
000f68  00                DCB      0
000f69  00                DCB      0
000f6a  00                DCB      0
000f6b  00                DCB      0
                          ENDP

                  MENU_AddItem PROC
;;;1138   */
;;;1139   void MENU_AddItem(MENU_Handle hObj, const MENU_ITEM_DATA* pItemData) {
000f6c  e92d41f0          PUSH     {r4-r8,lr}
000f70  4606              MOV      r6,r0
000f72  460d              MOV      r5,r1
;;;1140     if (hObj && pItemData) {
000f74  b326              CBZ      r6,|L1.4032|
000f76  b31d              CBZ      r5,|L1.4032|
;;;1141       MENU_Obj* pObj;
;;;1142       WM_LOCK();
;;;1143       pObj = MENU_H2P(hObj);
000f78  4630              MOV      r0,r6
000f7a  f7fffffe          BL       GUI_ALLOC_h2p
000f7e  4604              MOV      r4,r0
;;;1144       if (pObj) {
000f80  b1ec              CBZ      r4,|L1.4030|
;;;1145         if (GUI_ARRAY_AddItem(&pObj->ItemArray, NULL, 0) == 0) {
000f82  2200              MOVS     r2,#0
000f84  4611              MOV      r1,r2
000f86  f1040058          ADD      r0,r4,#0x58
000f8a  f7fffffe          BL       GUI_ARRAY_AddItem
000f8e  b9b0              CBNZ     r0,|L1.4030|
;;;1146           unsigned Index;
;;;1147           Index = MENU__GetNumItems(pObj) - 1;
000f90  4620              MOV      r0,r4
000f92  f7fffffe          BL       MENU__GetNumItems
000f96  f1a00701          SUB      r7,r0,#1
;;;1148           if (MENU__SetItem(hObj, pObj, Index, pItemData) == 0) {
000f9a  462b              MOV      r3,r5
000f9c  463a              MOV      r2,r7
000f9e  4621              MOV      r1,r4
000fa0  4630              MOV      r0,r6
000fa2  f7fffffe          BL       MENU__SetItem
000fa6  b928              CBNZ     r0,|L1.4020|
;;;1149             GUI_ARRAY_DeleteItem(&pObj->ItemArray, Index);
000fa8  4639              MOV      r1,r7
000faa  f1040058          ADD      r0,r4,#0x58
000fae  f7fffffe          BL       GUI_ARRAY_DeleteItem
000fb2  e003              B        |L1.4028|
                  |L1.4020|
;;;1150           } else {
;;;1151             MENU__ResizeMenu(hObj, pObj);
000fb4  4621              MOV      r1,r4
000fb6  4630              MOV      r0,r6
000fb8  f7fffffe          BL       MENU__ResizeMenu
                  |L1.4028|
;;;1152           }
;;;1153         }
000fbc  bf00              NOP      
                  |L1.4030|
;;;1154       }
;;;1155       WM_UNLOCK();
;;;1156     }
000fbe  bf00              NOP      
                  |L1.4032|
;;;1157   }
000fc0  e8bd81f0          POP      {r4-r8,pc}
;;;1158   
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  MENU__DefaultProps
                          DCD      0x00000000
                          DCD      0x00ffffff
                          DCD      0x007c7c7c
                          DCD      0x00d3d3d3
                          DCD      0x00ffffff
                          DCD      0x00d3d3d3
                          DCD      0x00980000
                          DCD      0x00d3d3d3
                          DCD      0x00980000
                          DCD      0x007c7c7c
000028  04040202          DCB      0x04,0x04,0x02,0x02
                          DCD      GUI_Font13_1
                  MENU__pDefaultEffect
                          DCD      WIDGET_Effect_3D1L
